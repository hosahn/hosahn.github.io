{"componentChunkName":"component---src-templates-post-template-tsx","path":"/220929/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h3>0. 들어가기 전에</h3>\n<p>레벨 9 이후부터는 본격적으로 해킹 공격 기법에 관한 문제들이 나온다!</p>\n<h3>1. level 9</h3>\n<p>드디어 첫(!) BOF…라고하기엔 너무 간단하지만, BOF문제다! cat hint를 실행하면 실행파일 소스 코드가 나온다. 일단 코드를 살펴보자.</p>\n<p>또한 이 파일은 <strong>Level 10</strong>의 권한을 가지고 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">main(){\r\n\r\n  char buf2[10];\r\n  char buf[10];\r\n\r\n  printf(\"It can be overflow : \");\r\n  fgets(buf,40,stdin);\r\n\r\n  if ( strncmp(buf2, \"go\", 2) == 0 )\r\n   {\r\n        printf(\"Good Skill!\\n\");\r\n        setreuid( 3010, 3010 );\r\n        system(\"/bin/bash\");\r\n   }\r\n\r\n}</code></pre></div>\n<p>buf2[10]과 buf[10]이라는 배열이 있는데, buf배열을 밑에 fgets함수에서 40개를 받는다.\r\n즉 오버플로우가 가능하단 소리다. buf2배열의 첫 두문자가 “go”인 경우에 password를\r\n준다고 하니, 정확히 buf2와 buf 배열의 거리가 얼마나 되나를 살펴봐야한다.</p>\n<p>실행권한은 없으니 복사해서 test.c를 만든다음 실행파일로 만들어서 한번 gdb로\r\n디버깅해보자. gdb는 리눅스의 어셈블리 디버거로, 활용하기 위해서 약간의 공부는 필요할 수 있다.</p>\n<p>일단 set disassembly-flavor intel을 콘솔창에 입력하자.</p>\n<p>disassemble (함수이름)을 하면 저 main함수가 시작될 때의 전체적인 어셈블리 코드를 확인해 볼 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">0x08048420 &lt;main+0>:    push   ebp\r\n0x08048421 &lt;main+1>:    mov    ebp,esp\r\n0x08048423 &lt;main+3>:    sub    esp,0x28\r\n0x08048426 &lt;main+6>:    and    esp,0xfffffff0\r\n0x08048429 &lt;main+9>:    mov    eax,0x0\r\n0x0804842e &lt;main+14>:   sub    esp,eax\r\n0x08048430 &lt;main+16>:   sub    esp,0xc\r\n0x08048433 &lt;main+19>:   push   0x8048554\r\n0x08048438 &lt;main+24>:   call   0x8048350 &lt;printf>\r\n0x0804843d &lt;main+29>:   add    esp,0x10\r\n0x08048440 &lt;main+32>:   sub    esp,0x4\r\n0x08048443 &lt;main+35>:   push   ds:0x8049698\r\n0x08048449 &lt;main+41>:   push   0x28\r\n0x0804844b &lt;main+43>:   lea    eax,[ebp-40]\r\n0x0804844e &lt;main+46>:   push   eax\r\n0x0804844f &lt;main+47>:   call   0x8048320 &lt;fgets>\r\n0x08048454 &lt;main+52>:   add    esp,0x10\r\n0x08048457 &lt;main+55>:   sub    esp,0x4\r\n0x0804845a &lt;main+58>:   push   0x2\r\n0x0804845c &lt;main+60>:   push   0x8048569\r\n0x08048461 &lt;main+65>:   lea    eax,[ebp-24]\r\n0x08048464 &lt;main+68>:   push   eax</code></pre></div>\n<p>대충 보면, lea가 배열 생성과 관련되어있다는걸 알 수있다. Linux 같은경우는\r\nlittle Endian을 사용하므로, 거꾸로 올라간다. 따라서 밑에 있는게 buf배열\r\n위에 있는게 buf2배열이라고 유추할 수 있다. 둘의 차는  40- 24이므로\r\n둘의 거리는 16이 된다. (원래는 10이어야하지만, 더미데이터 등의 이유로 6바이트가\r\n추가된듯 하다.)</p>\n<p>q로종료하고, 16개의 문자열 + go를 입력한다.</p>\n<p>interesting to hack!</p>\n<hr>\n<h2>Source</h2>\n<ul>\n<li>해커스쿨 FTZ</li>\n<li>Me!</li>\n</ul>","frontmatter":{"title":"시스템 해킹(7) : 해커스쿨 FTZ 레벨 9","summary":"","date":"2022.09.29.","before":"2022.09.28.","after":"2022.09.30.","categories":["C-SEC","KOR"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAANABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAYBBAcJ/8QAFQEBAQAAAAAAAAAAAAAAAAAABQT/2gAMAwEAAhADEAAAAecqxk1Wh+RFETf/xAAbEAACAwEBAQAAAAAAAAAAAAAEBQECAwYAB//aAAgBAQABBQLk/ozxAp6+x250njzKluVRkeVbT188ot//xAAfEQACAgIBBQAAAAAAAAAAAAACAwEEERMSACFRktL/2gAIAQMBAT8B2ipFjU+yabLh3VyNorN1QQFT5GXGOYTKlxiOWAzy7zES0vA+0/PX/8QAHREAAgIDAAMAAAAAAAAAAAAAAgMBBBITIQAx0f/aAAgBAgEBPwGuMuOvJoppdUSYJeCVbhTaYb2I2CkSIJsG50wXM2nOMz0t7I5krnPR/PP/xAAmEAACAQIGAQQDAAAAAAAAAAABAgMEEgAFERMhMSIUFSNBMpLh/9oACAEBAAY/Aq/KJs3zY0sdJFQ5E0NXLTS5PPNOWhqKYMHtowj1Hqqa2QS7aIgAYuPccyzQZjIslRTpWqoaOojgndd7eXht1bXSxdOT4AnHLc/ficEaq61NHJQkSC/bjHzI8Wv4yo6eL92ySL0xxtONVU3qLmtTstYo0CljoSR9jrHCn9v5j//EABwQAQEAAgIDAAAAAAAAAAAAAAERACFBUTFxgf/aAAgBAQABPyHWJvxKWgfi8l2Skpfpos8FGJji06G0TyMHZz1jUCzgTuk9EUsRNJkdSKwnsSquMiP35+M//9oADAMBAAIAAwAAABCQH//EABgRAQEBAQEAAAAAAAAAAAAAAAERACFx/9oACAEDAQE/EE+TpdStOdiavBQ21X17v//EABkRAAIDAQAAAAAAAAAAAAAAABEhAAFBMf/aAAgBAgEBPxB+k27FYwBSsS4wEHlQrAzBqpT/xAAZEAEBAQEBAQAAAAAAAAAAAAABESEAMUH/2gAIAQEAAT8Qm5D613Vaz4sCNvgJQCOeKY0zpwewxUIRguqIInPHcqiaKJ4IxFQZhRsyiwbhBPoTrDrq6VSjvqK/Xv/Z"},"images":{"fallback":{"src":"/static/19e515bba8750881aa8c0a71dc14e660/8c915/C_Sec.jpg","srcSet":"/static/19e515bba8750881aa8c0a71dc14e660/2e6e0/C_Sec.jpg 270w,\n/static/19e515bba8750881aa8c0a71dc14e660/edde1/C_Sec.jpg 540w,\n/static/19e515bba8750881aa8c0a71dc14e660/8c915/C_Sec.jpg 1080w","sizes":"(min-width: 1080px) 1080px, 100vw"},"sources":[{"srcSet":"/static/19e515bba8750881aa8c0a71dc14e660/2e1cd/C_Sec.webp 270w,\n/static/19e515bba8750881aa8c0a71dc14e660/08f1e/C_Sec.webp 540w,\n/static/19e515bba8750881aa8c0a71dc14e660/c34ed/C_Sec.webp 1080w","type":"image/webp","sizes":"(min-width: 1080px) 1080px, 100vw"}]},"width":1080,"height":720}},"publicURL":"/static/19e515bba8750881aa8c0a71dc14e660/C_Sec.jpg"}}}}]}},"pageContext":{"slug":"/220929/"}},"staticQueryHashes":[]}