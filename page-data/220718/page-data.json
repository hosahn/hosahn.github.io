{"componentChunkName":"component---src-templates-post-template-tsx","path":"/220718/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h3>0. Whom is this post for?</h3>\n<p>You know, it has been a trend making one’s own tech blog, especially not using the “boring” tools but coding your own web site.\r\nAnd as far as I know, Gatsby is the best option to make and manage your Tech Blog pretty easily. My Blog is also made with\r\nGatsby (coded with TS, but using JS would be also fine) and GraphQL.</p>\n<p>However, since Gatsby offers us to create a static web page, it is not easy to add a searching function to our blog.\r\nEverybody knows that we can’t send a query to Database, because we don’t even have a “proper” DB for our Gatsby blog.</p>\n<p>So if there is anybody who wants to add a searchbox, here is a (potential) solution with some code examples!</p>\n<h3>1. Using Static query to render.</h3>\n<p>Let’s assume that you have a Search.tsx or Search.jsx where you defined your Search Page Component.\r\nI used static Query to render.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">export default (props : any) => (\r\n  &lt;StaticQuery\r\n    query={graphql`\r\n    query abc {\r\n      site {\r\n        siteMetadata {\r\n          title\r\n          description\r\n          siteUrl\r\n        }\r\n      }\r\n      allMarkdownRemark(\r\n        sort: {frontmatter: {date: DESC} }  \r\n      ) {\r\n        edges {\r\n          node {\r\n            id\r\n            fields {\r\n              slug\r\n            }\r\n            frontmatter {\r\n              title\r\n              summary\r\n              date(formatString: \"YYYY.MM.DD.\")\r\n              categories\r\n              thumbnail {\r\n                childImageSharp {\r\n                  gatsbyImageData(width: 768, height: 400)\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n      file(name: { eq: \"profile-image\" }) {\r\n        childImageSharp {\r\n          gatsbyImageData(width: 120, height: 120)\r\n        }\r\n        publicURL\r\n      }\r\n    }\r\n  `}\r\n    render={(data) => &lt;Search data={data} {...props} />}\r\n  />\r\n);</code></pre></div>\n<h3>2. My <Search /> Component</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">export type SearchPageProps = {\r\n    location: {\r\n      search: string\r\n    }\r\n    data: {\r\n      allMarkdownRemark: {\r\n        edges: PostListItemType[]\r\n      }\r\n    }\r\n  }\r\n\r\ntype SearchMeta =  {\r\n    query : \"\",\r\n    filteredData : PostListItemType[]\r\n}\r\n\r\nconst Search = (props : SearchPageProps) => {\r\n  const emptyQuery = \"\";\r\n\r\n  const [state, setState] = useState&lt;SearchMeta>({\r\n    filteredData : [],\r\n    query: emptyQuery,\r\n  });\r\n\r\n  const handleInputChange = (event : any) => {\r\n    const query = event.target.value;\r\n    const { data } = props;\r\n    const posts = data.allMarkdownRemark.edges || [];\r\n\r\n    const filteredData : PostListItemType[] = posts.filter((post : PostListItemType) => {\r\n      const { summary, title, categories} = post.node.frontmatter;\r\n      return (\r\n        (summary &amp;&amp;\r\n          summary.toLowerCase().includes(query.toLowerCase())) ||\r\n        (title &amp;&amp; title.toLowerCase().includes(query.toLowerCase())) ||\r\n        (categories &amp;&amp; categories.join(\"\").toLowerCase().includes(query.toLowerCase()))\r\n      );\r\n    });\r\n\r\n    setState({\r\n      query,\r\n      filteredData,\r\n    });\r\n  };\r\n\r\n  const renderSearchResults = () => {\r\n    const { query, filteredData } = state;\r\n    const hasSearchResults = filteredData &amp;&amp; query !== emptyQuery;\r\n    const posts : PostListItemType[] = hasSearchResults ? filteredData : [];\r\n    return (\r\n      posts &amp;&amp;\r\n      &lt;SearchPostList posts = {posts} />\r\n    );\r\n  };\r\n\r\n  return (\r\n    &lt;div>\r\n          &lt;input\r\n            type=\"text\"\r\n            placeholder=\"Search\"\r\n            aria-label=\"Search\"\r\n            onChange={handleInputChange}\r\n          />\r\n      {state.query &amp;&amp; (\r\n        &lt;div>\r\n          {renderSearchResults()}\r\n        &lt;/div>\r\n      )}\r\n    &lt;/div>\r\n  );\r\n};</code></pre></div>\n<p>Where the type “PostListItem” is simply a type which is required to render the list of posts. You might have your\r\nown “PostListItem” since you offer a page where you show multiple posts of yours.</p>\n<h3>3. Need something more?</h3>\n<p>Basically, it is a simple logic. My posts have generally three text components : summary, title and categories.\r\nSince the user types the keyword to find, the query will be set and and find the filtered posts.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">  const handleInputChange = (event : any) => {\r\n    const query = event.target.value;\r\n    const { data } = props;\r\n    const posts = data.allMarkdownRemark.edges || [];\r\n\r\n    const filteredData : PostListItemType[] = posts.filter((post : PostListItemType) => {\r\n      const { summary, title, categories} = post.node.frontmatter;\r\n      return (\r\n        (summary &amp;&amp;\r\n          summary.toLowerCase().includes(query.toLowerCase())) ||\r\n        (title &amp;&amp; title.toLowerCase().includes(query.toLowerCase())) ||\r\n        (categories &amp;&amp; categories.join(\"\").toLowerCase().includes(query.toLowerCase()))\r\n      );\r\n    });\r\n\r\n    setState({\r\n      query,\r\n      filteredData,\r\n    });\r\n  };\r\n</code></pre></div>\n<p>Then, only the filtered posts are going to be rerendered and shown as a list,\r\nwhere the SearchPostList is my\r\nown component.</p>\n<p>P.S : I didn’t make this entire logic, but I saw a guy who actually build this logic for his blog.\r\nBut it wasn’t perfect by itself, thus, I changed some queries and logics, then I made it fit to my code (originally JS => TS) and to my own usage.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">  const renderSearchResults = () => {\r\n    const { query, filteredData } = state;\r\n    const hasSearchResults = filteredData &amp;&amp; query !== emptyQuery;\r\n    const posts : PostListItemType[] = hasSearchResults ? filteredData : [];\r\n    return (\r\n      posts &amp;&amp;\r\n      &lt;SearchPostList posts = {posts} />\r\n    );\r\n  };</code></pre></div>\n<hr>\n<h2>Source</h2>\n<ul>\n<li><a href=\"https://yohanpro.com/posts/gatsby-search\" target=\"_blank\" rel=\"nofollow\">Original Logic(in Korean)</a></li>\n</ul>","frontmatter":{"title":"How to add a searching page to your Tech Blog","summary":"using Gatsby & GraphQL, you can easily(?) add a search page to your own blog!","date":"2022.07.18.","before":"2022.07.17.","after":"2022.07.19.","categories":["Coding","ENG"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA60lEQVR42q2Ny07CQBSG5wlZuGFTVxp3DdjWIuAt6goitLZAuDyA1ZVNgRIqO+gTgYvS/pxOSBi7gSCTfDlzzsz/HaYZQ4jcmCMUDR8KkX07BPZnQDK14ULKS7gqPkC3p9Ca3vFC1Rih1HRxeZbD+YUM3Qpw/eZCaXhQSJxWdc8CVnonyRbdHKLS8vHUm+KxG+BlMCN+OM/9AK/U33cmEDNZmFz7hkih7uKuPUHZ9unDmC+4tca8r6ZzumczIqz9FUKk9RnC+pjDcuawnYVQd2QzIgwnPly4XK2IX8RxjCRJ/gUXRtH6JLJUuAFdFTlCNs479QAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/eb19302dfcb579552f8bc999a7e3370c/453e1/search.png","srcSet":"/static/eb19302dfcb579552f8bc999a7e3370c/1ae89/search.png 349w,\n/static/eb19302dfcb579552f8bc999a7e3370c/df23a/search.png 698w,\n/static/eb19302dfcb579552f8bc999a7e3370c/453e1/search.png 1396w","sizes":"(min-width: 1396px) 1396px, 100vw"},"sources":[{"srcSet":"/static/eb19302dfcb579552f8bc999a7e3370c/09bae/search.webp 349w,\n/static/eb19302dfcb579552f8bc999a7e3370c/f9203/search.webp 698w,\n/static/eb19302dfcb579552f8bc999a7e3370c/44d4e/search.webp 1396w","type":"image/webp","sizes":"(min-width: 1396px) 1396px, 100vw"}]},"width":1396,"height":609}},"publicURL":"/static/eb19302dfcb579552f8bc999a7e3370c/search.png"}}}}]}},"pageContext":{"slug":"/220718/"}},"staticQueryHashes":["1523927062"],"slicesMap":{}}